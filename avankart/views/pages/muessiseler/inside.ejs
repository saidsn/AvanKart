<div class="w-full">
                    <div class="w-full relative">
                        <!-- Arxa fon şəkli -->
                        <img src="/images/uzv-sirket/sirketMelumatlari/bgImage.svg" alt="Background Image"
                            class="w-full" />

                        <!-- Logo şəkli: Yarı hündürlüyü qədər yuxarı çıxsın -->
                        <img class="absolute w-24 h-24 z-10 left-5 -bottom-12"
                            src="/images/Avankart/muessiseler/logo.svg" alt="Logo" />
                    </div>
                    <div class="flex mt-[42px] w-[100%]">
                        <div class="w-[25%] px-3 border-r border-stroke pt-[12px] min-h-screen">
                            <div class="bg-sidebar-bg py-[10px] px-[12px] mb-[8px]">
                                <div class="flex justify-between items-center">
                                    <p class="text-12px font-medium text-messages pb-1">
                                        Dəyişikliyi təsdiqlə
                                    </p>
                                    <button
                                        type="button"
                                        id="confirmChangesBtn"
                                        class="border-[1px] border-surface-variant w-[131px] h-[27px] flex gap-[15px] justify-center items-center rounded-[100px] hover:cursor-pointer hover:text-focus text-[12px] font-medium text-messages"
                                        onclick="showChangesDiffModal()">
                                        Dəyişikliyi təsdiqlə
                                    </button>
                                </div>

                                <div class="flex items-center gap-2">
                                    <span class="text-[11px] font-normal text-messages opacity-50 pr-[3px]">Son düzəliş
                                        tarixi:</span>
                                    <span onclick="toggleMuessiseVersiyalariModal()"
                                        class="text-[11px] font-normal text-messages opacity-50 cursor-pointer hover:text-[#1D222B] hover:opacity-100 hover:underline"><%= newMuessise.updatedAt %></span>
                                    <img src="/images/Avankart/Sirketler/chevron-down.svg" alt="Chevron Down"
                                        class="w-4 h-4" />
                                </div>
                            </div>

                            <div class="bg-sidebar-bg py-[5.5px] px-[12px] mb-[8px]">
                                <span class="text-[12px] font-normal text-messages opacity-50 pr-[4px]">Üzv olduğu
                                    tarix:</span>
                                <span class="text-[12px] font-medium texy-mess"><%= newMuessise.createdAt %></span>
                            </div>
                            <!-- Your existing HTML remains the same -->
                            <div class="bg-sidebar-bg py-[5.5px] px-[12px]">
                                <span class="text-[12px] font-normal text-messages opacity-50 pr-[4px]">Yaradan
                                    şəxs</span>
                                <span class="text-[12px] font-medium text-messages"><%= newMuessise.creatorName %></span>
                            </div>

                            <div class="flex justify-center items-center gap-3 mt-2">
                                <button onclick="openMainEditPopup()"
                                    class="border border-surface-variant w-full h-[34px] flex gap-[10px] justify-center items-center rounded-full hover:cursor-pointer hover:text-focus text-[12px] font-medium text-messages">
                                    <span class="icon iconex-edit-1-1 text-sm text-messages"></span>
                                    Redaktə et
                                </button>
                                <div id="wrapper" class="relative inline-block text-left ">
                                    <div onclick="toggleDropdown(this)"
                                        class="relative border w-[34px] h-[34px] rounded-full flex items-center justify-center flex-none">
                                        <button id="threeDotBtn"
                                            class="icon stratis-dot-vertical cursor-pointer text-messages">
                                            ⋮
                                        </button>
                                    </div>

                                    <div class="hidden absolute right-[-12px] max-w-[244px] z-25 dropdown-menu">
                                        <div class="relative h-[8px]">
                                            <div
                                                class="absolute top-1/2 right-4 w-3 h-3 bg-menu rotate-45 border-l-[.5px] border-t-[.5px] z-50 border-[.5px] border-stroke">
                                            </div>
                                        </div>

                                        <div
                                            class="rounded-xl shadow-lg bg-menu overflow-hidden relative z-50 border-[.5px] border-stroke">
                                            <div class="py-[3.5px] text-sm">
                                                <div onclick="toggleDeAktivModal()"
                                                    class="flex items-center gap-2 px-4 py-[3.5px] hover:bg-error-hover cursor-pointer">
                                                    <span
                                                        class="icon stratis-minus-circle-contained text-error text-[13px]"></span>
                                                    <span
                                                        class="font-medium text-error text-[13px] whitespace-nowrap">Deaktiv
                                                        et</span>
                                                </div>
                                                <div class="h-[.5px] bg-stroke my-1"></div>
                                                <div onclick="toggleSilinmeMuracietPopUp()"
                                                    class="flex items-center gap-2 px-4 py-[3.5px] hover:bg-error-hover cursor-pointer">
                                                    <span class="icon stratis-trash-01 text-error text-[13px]"></span>
                                                    <span
                                                        class="font-medium text-error text-[13px] whitespace-nowrap">Silinmə
                                                        üçün müraciət et</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-[16px]">
                                <div class="flex justify-between items-center">
                                    <p class="text-[22px] font-semibold text-messages">
                                       <%= newMuessise.muessise_name %>
                                    </p>
                                    <button
                                        class="bg-sidebar-bg w-[60px] h-[25px] flex gap-[8px] items-center rounded-[100px] text-[12px] font-medium text-messages">
                                        <span class="w-[6px] h-[6px] rounded-full bg-[#00A3FF] shrink-0 ml-2"></span>
                                        <%= newMuessise.status %>
                                    </button>
                                </div>
                            </div>
                            <div class="mt-1">
                                <span class="py-[2.5px] flex items-center gap-[4px]">
                                    <span class="font-normal text-[12px] text-messages opacity-65">ID:</span>
                                    <span class="font-normal text-[12px] text-messages">
                                        <%= newMuessise.muessise_id %></span>
                                    <span class="icon iconex-copy-1 w-[12px] h-[15px] ml-[6px]"></span>
                                </span>
                            </div>
                            <p
                                class="pt-2 font-normal text-[12px] text-messages opacity-65 pb-[20px] border-b-[0.5px] border-[#0000001A]">
                                <%= newMuessise.description %>
                            </p>
                            <!-- asagidaki kommentler acilacaq datalar duzeldikde -->
                            
                            <div class="flex gap-4 flex-col pb-[20px] border-b-[0.5px] pt-4 border-[#0000001A]">
                                <div class="flex gap-[11px] items-center text-messages">
                                    <span class="mt-[6px] icon iconex-bookmark-1 !w-[13px] !h-[17px]"></span><span
                                        class="opacity-65 text-[13px] font-normal"><%= newMuessise.activity_type %></span>
                                </div>
                                <div class="flex gap-[11px] items-center text-messages">
                                    <span class="icon iconex-location-1 !w-[15px] !h-[17px]"></span><span
                                        class="opacity-65 text-[13px] font-normal"><%= newMuessise.address %></span>
                                </div>
                                <% newMuessise.phone?.forEach(item=> { %>
                                <div class="flex gap-[11px] items-center text-messages">
                                    <span class="icon iconex-calling-1 !w-[16px] !h-[16px]"></span><span
                                        class="opacity-65 text-[13px] font-normal"><%= item.prefix %> <%= item.number %></span>
                                </div>
                                <% }) %>
                                <% newMuessise.email?.forEach(item => { %>
                                <div class="flex gap-[11px] items-center text-messages">
                                    <span class="icon iconex-case-1 !w-[17px] !h-[16px]"></span><span
                                        class="opacity-65 text-[13px] font-normal"><%= item %></span>
                                </div>
                                <% }) %>
                            </div>
                            <div class="pt-4 pb-[20px] border-b-[0.5px] border-[#0000001A]">
                                <p class="text-[11px] font-medium opacity-50 text-messages pb-2">
                                    Kartlar
                                </p>
                                <div class="flex flex-wrap gap-3">
                                    <% newMuessise.cards?.forEach(card => { %>
                                    <div
                                    style="background-color: <%= card.background_color %>;"
                                        class="w-[84px] h-[27px] flex gap-1 items-center justify-center  rounded-full">
                                        <img class="w-[16px] h-[16px]"
                                            src="/images/muessise melumatlari images/<%= card.icon %>"
                                            alt="ForkKnife" />
                                        <span class="font-normal text-[12px] text-messages"><%= card.name %></span>
                                    </div>
                                    <% }) %>
                                </div>
                            </div>
                            <div class="pt-4 pb-5 border-b-[0.5px] border-[#0000001A]">
                                <p class="text-[11px] font-medium opacity-50 text-messages pb-2">
                                    İş günləri
                                </p>
                                <div class="flex gap-1 flex-wrap">
                                    <div class="flex gap-2">
                                        <%
                                        const dayIcons = {
                                            monday: "/images/muessise melumatlari images/Frame 427321302.svg",
                                            tuesday: "/images/muessise melumatlari images/Frame 427321302 (1).svg",
                                            wednesday: "/images/muessise melumatlari images/Frame 427321302 (2).svg",
                                            thursday: "/images/muessise melumatlari images/Frame 427321302 (3).svg",
                                            friday: "/images/muessise melumatlari images/Frame 427321302 (4).svg",
                                            saturday: "/images/muessise melumatlari images/Frame 427321302 (5).svg",
                                            sunday: "/images/muessise melumatlari images/Frame 427321302 (6).svg"
                                        };
                                        %>
                                            <% Object.entries(newMuessise.schedule || {}).forEach(([key, value]) => { %>
                                            <div class="relative group">
                                                <img class="w-[34px] h-[34px]"
                                                    src="<%= dayIcons[key] %>"
                                                    alt="<%= key %>" />

                                                <div
                                                class="absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-max px-2 py-1 text-xs text-on-primary bg-messages rounded opacity-0 group-hover:opacity-100 transition-opacity z-5555510">
                                                <% if (key === 'sunday' || !value || value === false) { %>
                                                        İş günü yoxdur
                                                    <% } else { %>
                                                        <%= value %>
                                                    <% } %>

                                                <div   class="absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-8 border-r-8 border-t-[8px] border-t-messages border-transparent z-15">
                                                </div>
                                                </div>
                                            </div>
                                        <% }) %>
                                    </div>

                                    
                                </div>
                            </div>
                            <div class="pt-4 pb-4 border-b-[0.5px] border-[#0000001A]">
                                <p class="text-[11px] font-medium opacity-50 text-messages pb-2">
                                    Xidmətlər
                                </p>
                                <div class="flex gap-3">
                                    <% newMuessise.services?.forEach(item => { %>
                                    <div
                                        class=" bg-focus text-[12px] py-1 px-2 text-on-primary flex items-center justify-center rounded-full">
                                        <%= item %>
                                    </div>
                                    <% }) %>
                                </div>
                            </div>
                            <div class="pt-4 pb-5 border-b-[0.5px] border-[#0000001A]">
                                <p class="text-[11px] font-medium opacity-50 text-messages pb-2">
                                    Sosial media
                                </p>
                                <div class="flex flex-col">
                                    <% newMuessise.social?.forEach(([key, value]) => { %>
                                        <div class="p-3 flex items-center justify-between border-b-[0.5px] border-[#0000001A] hover:bg-table-hover">
                                            <div class="flex items-center gap-2">
                                                <img src="/images/muessise melumatlari images/devicon_<%= key %>.svg" alt="<%= key %>" />
                                                <span class="text-[13px] font-medium text-messages opacity-65"><%= key %></span>
                                            </div>
                                            <div class="icon stratis-link-external text-xs"></div>
                                        </div>
                                    <% }) %>
                                </div>
                            </div>
                            <div class="pt-4 pb-5 border-b-[0.5px] border-[#0000001A] mb-[17px]">
                                <p class="text-[11px] font-medium opacity-50 text-messages pb-2">
                                    Web sayt
                                </p>
                                <% newMuessise.website?.forEach(item=> { %>
                                <div class="p-3 flex gap-2 items-center hover:bg-table-hover">
                                    
                                    <div class="icon iconex-link-1 w-[9px] h-[17px]"></div>
                                    <span
                                        class="text-[13px] font-medium text-messages opacity-65"><%= item %></span>
                                        
                                </div>
                                <% }) %>
                            </div>
                        </div>
                        <div class="max-w-[75%] px-5 w-[100%]">
                            <div class="flex flex-col">
                                <div class="flex flex-col gap-4">
                                    <div class="border-b border-stroke inline-block">
                                        <ul
                                            class="inline-flex flex-wrap gap-5 -mb-px text-[13px] font-medium text-center text-gray-600">
                                            <li>
                                                <a href="#"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg text-messages border-b-2 border-messages"
                                                    data-tab="dashboard">
                                                    Dashboard
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg"
                                                    data-tab="istifadeciler">
                                                    İstifadəçilər
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    onclick="loadNotificationsData('<%= newMuessise.muessise_id %>')"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg"
                                                    data-tab="bildirisler">
                                                    Bildirişlər
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg"
                                                    data-tab="rekvizitler">
                                                    Rekvizitlər
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg"
                                                    data-tab="muqavileler">
                                                    Müqavilələr
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg"
                                                    data-tab="emeliyyatlar">
                                                    Əməliyyatlar
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    onclick="loadQueriesData('<%= newMuessise.muessise_id %>')"
                                                    class="main-tab-link inline-flex items-center justify-center py-2 rounded-t-lg"
                                                    data-tab="sorgular">
                                                    Sorğular
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <div id="tab-content">
                                    <div id="dashboard" class="main-tab-content">
                                        <div class="w-full flex flex-col gap-3 py-3">
                                            <div
                                                class="w-full mx-auto px-4 py-4 rounded-lg h-96 bg-container-2 dark:bg-container-2-dark">
                                                <div class="flex justify-between">
                                                    <div
                                                        class="relative h-[35px] pl-6 pr-17 flex items-center overflow-hidden -mt-[10px]">
                                                        <div
                                                            class="absolute w-[22px] h-[23px] rotate-65 right-0 border-r border-secondary mt-[4px]">
                                                        </div>
                                                        <div
                                                            class="font-medium text-[15px] whitespace-nowrap dark:text-primary-text-color-dark">
                                                            Tranzaksiya sayı
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 bg-[#07DBFA] w-[29px] h-[3px] -ml-2 z-[1] border-r-[3px] border-container-2 dark:border-container-2-dark border-before [clip-path:polygon(100%_0,100%_100%,0_100%,2px_0)]">
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 w-[calc(100%-39px)] border-b border-secondary mb-[1px]">
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="flex items-center gap-1 w-full overflow-hidden justify-end relative">
                                                        <div class="absolute w-full  border-b border-secondary">
                                                        </div>
                                                    </div>
                                                    <div class="flex gap-1 items-center">
                                                        <div
                                                            class="flex justify-between min-w-96 py-1 px-1 rounded-full bg-menu dark:bg-menu-dark items-center border border-stroke dark:border-surface-variant-dark">
                                                            <div data-day="all"
                                                                class="transactionsTab text-[11px] font-medium cursor-pointer text-messages dark:text-primary-text-color-dark bg-inverse-on-surface dark:bg-inverse-on-surface-dark rounded-full py-[3px] px-2 flex items-center justify-center">
                                                                Hamısı
                                                            </div>
                                                            <div data-day="15"
                                                                class="transactionsTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                15 günlük
                                                            </div>
                                                            <div data-day="month"
                                                                class="transactionsTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                1 ay
                                                            </div>
                                                            <div data-day="3-m"
                                                                class="transactionsTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                3 ay
                                                            </div>
                                                            <div data-day="6-m"
                                                                class="transactionsTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                6 ay
                                                            </div>
                                                            <div data-day="year"
                                                                class="transactionsTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                12 ay
                                                            </div>
                                                            <div onclick="openDateModal('transaction')"
                                                                class="text-[11px] pl-1 font-medium cursor-pointer text-messages dark:text-primary-text-color-dark dark:hover:text-messages hover:bg-[#F6D9FF] rounded-full flex items-center gap-1 py-[3px] px-2">
                                                                <div class="icon stratis-calendar-02"></div>
                                                                Tarix əlavə et
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <canvas id="transactionsChart" class="pb-17"></canvas>
                                                <div
                                                    class="text-center text-sm text-tertiary-text dark:text-tertiary-text-color-dark">
                                                    <div
                                                        class="text-center text-xs font-medium text-messages dark:text-primary-text-color-dark flex items-center justify-center gap-1 -mt-14">
                                                        <div
                                                            class="relative overflow-hidden w-4 h-4 rounded-full bg-[#6FD195A1] flex items-center justify-center">
                                                            <div
                                                                class="border-[1px] border-menu dark:border-menu-dark bg-[#6FD195] w-2 h-2 rounded-full z-1">
                                                            </div>
                                                            <div
                                                                class="w-full h-[2px] bg-[#6FD195] absolute top-1/2 -translate-y-1/2">
                                                            </div>
                                                        </div>
                                                        <span
                                                            class="text-tertiary-text dark:text-tertiary-text-color-dark font-normal">Tranzaksiya
                                                            sayı:</span>
                                                        <span
                                                          id="transactionsCount"
                                                            class="text-messages dark:text-primary-text-color-dark"> 0 </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="w-full mx-auto px-4 py-4 rounded-lg h-96 bg-container-2">
                                                <div class="flex justify-between">
                                                    <div
                                                        class="relative h-[35px] pl-6 pr-17 flex items-center overflow-hidden -mt-[10px]">
                                                        <div
                                                            class="absolute w-[22px] h-[23px] rotate-65 right-0 border-r border-secondary mt-[4px]">
                                                        </div>
                                                        <div
                                                            class="font-medium text-[15px] whitespace-nowrap dark:text-primary-text-color-dark">
                                                            Hesablaşma 
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 bg-[#07DBFA] w-[29px] h-[3px] -ml-2 z-[1] border-r-[3px] border-container-2 dark:border-container-2-dark border-before [clip-path:polygon(100%_0,100%_100%,0_100%,2px_0)]">
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 w-[calc(100%-39px)] border-b border-secondary mb-[1px]">
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="flex items-center gap-1 w-full overflow-hidden justify-end relative">
                                                        <div class="absolute w-full  border-b border-secondary">
                                                        </div>
                                                    </div>
                                                    <div class="flex gap-1 items-center">
                                                        <div
                                                            class="flex justify-between min-w-96 py-1 px-1 rounded-full bg-menu dark:bg-menu-dark items-center border border-stroke dark:border-surface-variant-dark">
                                                            <div data-day="all"
                                                                class="hesablasmaTab text-[11px] font-medium cursor-pointer text-messages dark:text-primary-text-color-dark bg-inverse-on-surface dark:bg-inverse-on-surface-dark rounded-full py-[3px] px-2 flex items-center justify-center">
                                                                Hamısı
                                                            </div>
                                                            <div data-day="15"
                                                                class="hesablasmaTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                15 günlük
                                                            </div>
                                                            <div
                                                                data-day="month"
                                                                class="hesablasmaTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                1 ay
                                                            </div>
                                                            <div
                                                                data-day="3-m"
                                                                class="hesablasmaTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                3 ay
                                                            </div>
                                                            <div data-day="6-m"
                                                                class="hesablasmaTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                6 ay
                                                            </div>
                                                            <div
                                                                data-day="year"
                                                                class="hesablasmaTab text-[11px] font-medium cursor-pointer text-tertiary-text dark:text-tertiary-text-color-dark hover:text-messages dark:hover:text-primary-text-color-dark rounded-full py-[3px] px-2">
                                                                12 ay
                                                            </div>
                                                            <div onclick="openDateModal('hesablasma')"
                                                                class="text-[11px] pl-1 font-medium cursor-pointer text-messages dark:text-primary-text-color-dark dark:hover:text-messages hover:bg-[#F6D9FF] rounded-full flex items-center gap-1 py-[3px] px-2">
                                                                <div class="icon stratis-calendar-02"></div>
                                                                Tarix əlavə et
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-full h-96">
                                                    <div class="flex items-center justify-between">
                                                        <div class="w-1/2">
                                                            <canvas id="hesablasmaDoughnut"
                                                                class="w-[400px] h-[300px]"></canvas>
                                                        </div>
                                                        <div class="w-1/2" id="hesablasmaLegend"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                class="w-full mx-auto px-4 py-4 rounded-lg h-96 bg-container-2 dark:bg-container-2-dark">
                                                <div class="flex justify-between">
                                                    <div
                                                        class="relative h-[35px] pl-6 pr-10 flex items-center overflow-hidden -mt-[10px]">
                                                        <div
                                                            class="absolute w-[22px] h-[23px] rotate-65 right-0 border-r border-secondary mt-[4px]">
                                                        </div>
                                                        <div
                                                            class="font-medium text-[15px] whitespace-nowrap dark:text-primary-text-color-dark">
                                                            Məbləğ
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 bg-[#07DBFA] w-[29px] h-[3px] -ml-2 z-[1] border-r-[3px] border-container-2 dark:border-container-2-dark border-before [clip-path:polygon(100%_0,100%_100%,0_100%,2px_0)]">
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 w-[calc(100%-39px)] border-b border-secondary mb-[1px]">
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="flex items-center gap-1 w-full overflow-hidden justify-end relative">
                                                        <div class="absolute w-full  border-b border-secondary">
                                                        </div>
                                                    </div>
                                                    <div class="relative inline-block ml-3">
                                                        <!-- Dropdown Toggle -->
                                                        <div id="yearDropdownToggle"
                                                            class="z-[2] flex items-center justify-center gap-[9px] text-[12px] text-messages dark:text-primary-text-color-dark font-normal w-20 h-[34px] py-1 px-2 rounded-full bg-menu dark:bg-menu-dark cursor-pointer border border-stroke dark:border-[#FFFFFF1A]">
                                                            <span>2025</span>
                                                            <div class="relative flex items-center justify-center mt-2">
                                                                <div class="icon stratis-chevron-right rotate-90"></div>
                                                            </div>
                                                        </div>

                                                        <!-- Dropdown Content -->
                                                        <div id="yearDropdown"
                                                            class="absolute hidden overflow-hidden pt-1 pr-1 z-10 mt-1 right-0 w-20 bg-menu dark:bg-menu-dark border-[.5px] border-stroke dark:border-[#FFFFFF1A] rounded-[8px] shadow-lg">
                                                            <!-- Scroll burdadır -->
                                                            <ul
                                                                class="custom-scroll overflow-y-auto max-h-40 flex flex-col text-center text-[13px] text-messages dark:text-primary-text-color-dark font-medium pt-1 px-1 space-y-[2px]">
                                                                <!-- JS ilə dinamik illər buraya əlavə olunur -->
                                                                 <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2025
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2024
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2023
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2022
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2021
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2020
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2019
                                                                </li>
                                                                <li
                                                                    class="cursor-pointer text-[13px] font-medium text-messages dark:text-primary-text-color-dark px-3 py-[3.5px] rounded hover:bg-item-hover dark:hover:bg-item-hover-dark">
                                                                    2018
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <canvas id="qrChart" class="pb-17"></canvas>
                                                <div
                                                    class="text-center text-sm text-tertiary-text dark:text-tertiary-text-color-dark">
                                                    <div
                                                        class="text-center text-xs font-medium text-messages dark:text-primary-text-color-dark flex items-center justify-center gap-1 -mt-14">
                                                        <div
                                                            class="relative overflow-hidden w-4 h-4 rounded-full bg-[#7086FDA1] flex items-center justify-center">
                                                            <div
                                                                class="border-[1px] border-menu dark:border-menu-dark bg-[#7086FD] w-2 h-2 rounded-full z-1">
                                                            </div>
                                                            <div
                                                                class="w-full h-[2px] bg-[#7086FD] absolute top-1/2 -translate-y-1/2">
                                                            </div>
                                                        </div>
                                                        <span
                                                            class="text-tertiary-text dark:text-tertiary-text-color-dark font-normal">Müştərilərin
                                                            müəssisəyə ödədiyi məbləğ:</span>
                                                        <span id="qrCount"
                                                            class="text-messages dark:text-primary-text-color-dark">
                                                            AZN</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="w-full bg-container-2 dark:bg-container-2-dark rounded-lg">
                                                <div class="flex justify-between px-4 py-4">
                                                    <div
                                                        class="relative h-[35px] pl-6 pr-2 flex items-center -mt-[9px]">
                                                        <div
                                                            class="absolute w-[22px] h-[23px] rotate-65 right-0 border-r border-secondary mt-[4px]">
                                                        </div>
                                                        <div
                                                            class="font-medium text-[15px] whitespace-nowrap dark:text-primary-text-color-dark">
                                                            Kartlar üzrə toplam məbləğ
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 bg-[#07DBFA] w-[29px] h-[3px] -ml-2 z-[1] border-r-[3px] border-container-2 dark:border-container-2-dark border-before [clip-path:polygon(100%_0,100%_100%,0_100%,2px_0)]">
                                                        </div>
                                                        <div
                                                            class="absolute bottom-0 w-[calc(100%-39px)] border-b border-secondary mb-[1px]">
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="flex items-center gap-1 w-full overflow-hidden justify-end relative mb-[2px]">
                                                        <div class="absolute w-full  border-b border-secondary">
                                                        </div>
                                                    </div>
                                                    <div class="flex items-center gap-1">
                                                        <div class="relative inline-block ">
                                                            <!-- Dropdown Toggle -->
                                                            <div onclick="openKartlarModal()"
                                                                class="z-[2] flex items-center justify-between gap-[9px] text-[12px] text-messages dark:text-primary-text-color-dark font-normal w-25 h-[34px] py-1 px-3 rounded-full bg-menu dark:bg-menu-dark cursor-pointer border border-stroke dark:border-[#FFFFFF1A]">
                                                                <span>Kartlar</span>
                                                                <div
                                                                    class="relative flex items-center justify-center mt-2">
                                                                    <div class="icon stratis-chevron-right rotate-90">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="relative inline-block ">
                                                            <!-- Dropdown Toggle -->
                                                            <div onclick="openYearsModal()"
                                                                class="z-[2] flex items-center justify-between gap-[9px] text-[12px] text-messages dark:text-primary-text-color-dark font-normal w-[93px] h-[34px] py-1 px-3 rounded-full bg-menu dark:bg-menu-dark cursor-pointer border border-stroke dark:border-[#FFFFFF1A]">
                                                                <span>İllər</span>
                                                                <div
                                                                    class="relative flex items-center justify-center mt-2">
                                                                    <div class="icon stratis-chevron-right rotate-90">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="flex w-full gap-3 px-4">
                                                    <div
                                                        class="min-w-[50%] py-4 rounded-lg h-96 bg-container-2 dark:bg-container-2-dark">
                                                        <!-- Qrafiklər -->
                                                        <div class="flex gap-4 h-[300px] pb-5">
                                                            <!-- Sol: Xətti qrafik və alt label -->
                                                            <div class="w-full flex flex-col">
                                                                <canvas id="mexaricChart"
                                                                    class="w-full h-full"></canvas>
                                                                <!-- Etiketlər buraya daxil edildi -->
                                                                <div class="text-center text-sm text-tertiary-text dark:text-tertiary-text-color-dark flex gap-3 justify-center flex-wrap mt-3"
                                                                    id="mexaricChartLabels">
                                                                    <!-- Dinamik etiketlər -->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="min-w-[50%] py-4 rounded-lg h-96 bg-container-2 dark:bg-container-2-dark">
                                                        <div class="flex items-center justify-between">
                                                            <div class="w-1/2">
                                                                <canvas id="kartlarMexaricDoughnut"
                                                                    class="w-[400px] h-[300px]"></canvas>
                                                            </div>
                                                            <div class="w-1/2" id="kartlarMexaricDoughnutLegend"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="istifadeciler" class="main-tab-content hidden">
                                        <div id="istifadecilerContent">
                                            <div
                                                class="flex items-center justify-between gap-4 py-3 border-b-[.5px] border-stroke">
                                                <div class="flex items-center justify-between">
                                                    <div
                                                        class="inline-flex gap-1 items-center border border-stroke rounded-full p-1">
                                                        <button data-tab="tab-user-content"
                                                            class="notification-type active bg-inverse-on-surface text-messages rounded-full py-[3px] px-3 text-[12px] font-medium">
                                                            İstifadəçilər
                                                        </button>
                                                        <button data-tab="tab-permissions-content"
                                                            class="notification-type text-tertiary-text cursor-pointer rounded-full py-[3px] px-3 text-[12px] font-medium">
                                                            Səlahiyyət qrupları
                                                        </button>
                                                        <button data-tab="tab-roles-content"
                                                            class="notification-type text-tertiary-text cursor-pointer rounded-full py-[3px] px-3 text-[12px] font-medium">
                                                            Vəzifələr
                                                        </button>
                                                    </div>
                                                </div>

                                                <div id="userSearchContainer" class="flex items-center gap-2">
                                                    <div
                                                        class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                        <input id="userSearch" type="text" placeholder="Search..."
                                                            class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                        <div class="absolute right-3">
                                                            <div
                                                                class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="refreshUserTableBtn"
                                                        class="w-[155px] h-[34px] cursor-pointer border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                        <span class="text-[13px] font-medium">Səhifəni yenilə</span>
                                                        <span
                                                            class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                    </div>
                                                </div>

                                                <div id="selahiyyetSearchContainer"
                                                    class="flex items-center gap-2 hidden">
                                                    <div
                                                        class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                        <input id="selahiyyetSearch" type="text" placeholder="Search..."
                                                            class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                        <div class="absolute right-3">
                                                            <div
                                                                class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="rbacRefreshBtn"
                                                        class="w-[155px] h-[34px] cursor-pointer border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                        <span class="text-[13px] font-medium">Səhifəni yenilə</span>
                                                        <span
                                                            class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                    </div>
                                                </div>

                                                <div id="jobSearchContainer" class="flex items-center gap-2 hidden">
                                                    <div
                                                        class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                        <input id="jobSearch" type="text" placeholder="Search..."
                                                            class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                        <div class="absolute right-3">
                                                            <div
                                                                class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="jobRefreshBtn"
                                                        class="w-[155px] h-[34px] cursor-pointer border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                        <span class="text-[13px] font-medium">Səhifəni yenilə</span>
                                                        <span
                                                            class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="w-full">
                                                <div id="tab-user-content" class="sub-tab-content">
                                                    <div
                                                        class="w-full rounded-[8px] mt-3 flex flex-col gap-3 mb-2 relative">
                                                        <table id="userTable">
                                                            <thead class="border-none pb-0.5">
                                                                <tr
                                                                    class="bg-container-2 border-none text-xs text-tertiary-text font-base !h-[40px] dark:bg-table-hover-dark dark:text-white">
                                                                    <th class="filtering rounded-l-lg">
                                                                        Ad və soyad
                                                                    </th>
                                                                    <th class="filtering">Cinsi</th>
                                                                    <th class="filtering">Vəzifəsi</th>
                                                                    <th class="filtering">E-poçt</th>
                                                                    <th class="filtering">Telefon nömrəsi</th>
                                                                    <th class="filtering rounded-r-lg">Qrup</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody class="font-base text-xs"></tbody>
                                                        </table>
                                                    </div>
                                                    <div class="pt-2">
                                                        <div
                                                            class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                            <div class="py-5 flex items-center justify-between">
                                                                <div class="text-[13px] flex items-center gap-2">
                                                                    <span class="font-normal opacity-65">Səhifə
                                                                        sayı:</span>
                                                                    <span id="userTablePageCount" class="font-medium">1
                                                                        / 1</span>
                                                                </div>
                                                                <div class="flex items-center gap-5">
                                                                    <div>
                                                                        <div id="userPagination"
                                                                            class="flex items-center">
                                                                            <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                                onclick="changePage(0)">
                                                                                <div
                                                                                    class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                                </div>
                                                                            </div>
                                                                            <div class="flex gap-2">
                                                                                <button
                                                                                    class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages bg-[#F6D9FF] text-messages"
                                                                                    onclick="changePage(0)">
                                                                                    1
                                                                                </button>
                                                                            </div>
                                                                            <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                                onclick="changePage(0)">
                                                                                <div
                                                                                    class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div>
                                                                        <input
                                                                            class="user-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                            type="text" placeholder="Səhifə" />
                                                                        <a href="#"
                                                                            class="user-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="tab-permissions-content" class="sub-tab-content hidden">
                                                    <div
                                                        class="w-full rounded-[8px] mt-3 flex flex-col gap-3 mb-2 relative">
                                                        <table id="selahiyyetTable">
                                                            <thead class="border-none pb-0.5">
                                                                <tr
                                                                    class="bg-container-2 border-none text-xs text-tertiary-text font-base !h-[40px] dark:bg-table-hover-dark dark:text-white">
                                                                    <th class="filtering rounded-l-lg">
                                                                        Qrup adı
                                                                    </th>
                                                                    <th class="filtering">İcazələr</th>
                                                                    <th class="filtering">Şəxs sayı</th>
                                                                    <th class="filtering rounded-r-lg">
                                                                        Qrupun yaranma tarixi
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody class="font-base text-xs"></tbody>
                                                        </table>
                                                    </div>
                                                    <div class="pt-2">
                                                        <div
                                                            class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                            <div class="py-5 flex items-center justify-between">
                                                                <div class="text-[13px] flex items-center gap-2">
                                                                    <span class="font-normal opacity-65">Səhifə
                                                                        sayı:</span>
                                                                    <span id="selahiyyetTablePageCount"
                                                                        class="font-medium">1 / 1</span>
                                                                </div>
                                                                <div class="flex items-center gap-5">
                                                                    <div>
                                                                        <div id="selahiyyetPagination"
                                                                            class="flex items-center">
                                                                            <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                                onclick="changePage(0)">
                                                                                <div
                                                                                    class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                                </div>
                                                                            </div>
                                                                            <div class="flex gap-2">
                                                                                <button
                                                                                    class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages bg-[#F6D9FF] text-messages"
                                                                                    onclick="changePage(0)">
                                                                                    1
                                                                                </button>
                                                                            </div>
                                                                            <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                                onclick="changePage(0)">
                                                                                <div
                                                                                    class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div>
                                                                        <input
                                                                            class="selahiyyet-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                            type="text" placeholder="Səhifə" />
                                                                        <a href="#"
                                                                            class="selahiyyet-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="tab-roles-content" class="sub-tab-content hidden">
                                                    <div
                                                        class="w-full rounded-[8px] mt-3 flex flex-col gap-3 mb-2 relative">
                                                        <table id="jobTable">
                                                            <thead class="border-none pb-0.5">
                                                                <tr
                                                                    class="bg-container-2 border-none text-xs text-tertiary-text font-base !h-[40px] dark:bg-table-hover-dark dark:text-white">
                                                                    <th class="filtering rounded-l-lg">
                                                                        Qrup adı
                                                                    </th>
                                                                    <th class="filtering">Şəxs sayı</th>
                                                                    <th class="filtering rounded-r-lg">
                                                                        Qrupun yaranma tarixi
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody class="font-base text-xs"></tbody>
                                                        </table>
                                                    </div>
                                                    <div class="pt-2">
                                                        <div
                                                            class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                            <div class="py-5 flex items-center justify-between">
                                                                <div class="text-[13px] flex items-center gap-2">
                                                                    <span class="font-normal opacity-65">Səhifə
                                                                        sayı:</span>
                                                                    <span id="jobTablePageCount" class="font-medium">1 /
                                                                        1</span>
                                                                </div>
                                                                <div class="flex items-center gap-5">
                                                                    <div>
                                                                        <div id="jobPagination"
                                                                            class="flex items-center">
                                                                            <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                                onclick="changeJobPage(0)">
                                                                                <div
                                                                                    class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                                </div>
                                                                            </div>
                                                                            <div class="flex gap-2">
                                                                                <button
                                                                                    class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages bg-[#F6D9FF] text-messages"
                                                                                    onclick="changeJobPage(0)">
                                                                                    1
                                                                                </button>
                                                                            </div>
                                                                            <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                                onclick="changeJobPage(0)">
                                                                                <div
                                                                                    class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div>
                                                                        <input
                                                                            class="job-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                            type="text" placeholder="Səhifə" />
                                                                        <a href="#"
                                                                            class="job-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="selahiyyetDetail" class="hidden">
                                            <div class="flex flex-col gap-3 py-3">
                                                <div
                                                    class="flex items-center justify-between text-messages border-b-[.5px] border-stroke pb-3">
                                                    <div id="backToIStifadecilerContent"
                                                        class="flex items-center gap-2 cursor-pointer">
                                                        <div id="backToIstifadeciText" class="icon stratis-arrow-left-sm text-xs"></div>
                                                        Sistem inzibatçısı
                                                    </div>
                                                    <div class="flex items-center gap-2">
                                                        <div
                                                            class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                            <input id="selahiyyetDetailSearch" type="text"
                                                                placeholder="Search..."
                                                                class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                            <div class="absolute right-3">
                                                                <div
                                                                    class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div  id="selahiyyetDetailrefreshBtn"
                                                            class="w-[155px] h-[34px] cursor-pointer border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                            <span class="text-[13px] font-medium">Səhifəni
                                                                yenilə</span>
                                                            <span
                                                                class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                        </div>
                                                        <div onclick="openFilterModal()"
                                                            class="w-[103px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                            <div
                                                                class="icon stratis-filter text-messages dark:text-primary-text-color-dark mt-[2.5px]">
                                                            </div>
                                                            <span class="">Filterlə</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-full rounded-[8px] flex flex-col gap-3 mb-2 relative">
                                                    <table id="selahiyyetDetailTable">
                                                        <thead class="border-none pb-0.5">
                                                            <tr
                                                                class="bg-container-2 border-none text-xs text-tertiary-text font-base !h-[40px] dark:bg-table-hover-dark dark:text-white">
                                                                <th class="filtering rounded-l-lg">
                                                                    Ad və soyad
                                                                </th>
                                                                <th class="filtering">Cinsi</th>
                                                                <th class="filtering">Vəzifəsi</th>
                                                                <th class="filtering">Email</th>
                                                                <th class="filtering rounded-r-lg">
                                                                    Telefon nömrəsi
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="font-base text-xs"></tbody>
                                                    </table>
                                                </div>
                                                <div class="pt-2">
                                                    <div
                                                        class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                        <div class="py-5 flex items-center justify-between">
                                                            <div class="text-[13px] flex items-center gap-2">
                                                                <span class="font-normal opacity-65">Səhifə sayı:</span>
                                                                <span id="selahiyyetDetailTablePageCount"
                                                                    class="font-medium">1 / 1</span>
                                                            </div>
                                                            <div class="flex items-center gap-5">
                                                                <div>
                                                                    <div id="selahiyyetDetailPagination"
                                                                        class="flex items-center">
                                                                        <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changePage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                        <div class="flex gap-2">
                                                                            <button
                                                                                class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages bg-[#F6D9FF] text-messages"
                                                                                onclick="changePage(0)">
                                                                                1
                                                                            </button>
                                                                        </div>
                                                                        <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changePage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <input
                                                                        class="selahiyyetDetail-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                        type="text" placeholder="Səhifə" />
                                                                    <a href="#"
                                                                        class="selahiyyetDetail-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="jobDetail" class="hidden">
                                            <div class="flex flex-col gap-3 py-3">
                                                <div
                                                    class="flex items-center justify-between text-messages border-b-[.5px] border-stroke pb-3">
                                                    <div id="backToJobContent"
                                                        class="flex items-center gap-2 cursor-pointer">
                                                        <div class="icon stratis-arrow-left-sm text-xs"></div>
                                                        Mühasib ()
                                                    </div>
                                                    <div class="flex items-center gap-2">
                                                        <div
                                                            class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                            <input id="jobDetailSearch" type="text"
                                                                placeholder="Search..."
                                                                class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                            <div class="absolute right-3">
                                                                <div
                                                                    class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div id="jobDetailRefreshBtn"
                                                            class="w-[155px] h-[34px] border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                            <span class="text-[13px] font-medium">Səhifəni
                                                                yenilə</span>
                                                            <span
                                                                class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="w-full rounded-[8px] flex flex-col gap-3 mb-2 relative">
                                                    <table id="jobDetailTable">
                                                        <thead class="border-none pb-0.5">
                                                            <tr
                                                                class="bg-container-2 border-none text-xs text-tertiary-text font-base !h-[40px] dark:bg-table-hover-dark dark:text-white">
                                                                <th class="filtering rounded-l-lg">
                                                                    Ad və soyad
                                                                </th>
                                                                <th class="filtering">Cinsi</th>
                                                                <th class="filtering">Vəzifəsi</th>
                                                                <th class="filtering">Email</th>
                                                                <th class="filtering rounded-r-lg">
                                                                    Telefon nömrəsi
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody class="font-base text-xs"></tbody>
                                                    </table>
                                                </div>
                                                <div class="pt-2">
                                                    <div
                                                        class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                        <div class="py-5 flex items-center justify-between">
                                                            <div class="text-[13px] flex items-center gap-2">
                                                                <span class="font-normal opacity-65">Səhifə sayı:</span>
                                                                <span id="jobDetailTablePageCount" class="font-medium">1
                                                                    / 1</span>
                                                            </div>
                                                            <div class="flex items-center gap-5">
                                                                <div>
                                                                    <div id="jobDetailPagination"
                                                                        class="flex items-center">
                                                                        <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changejobDetailPage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                        <div class="flex gap-2">
                                                                            <button
                                                                                class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages bg-[#F6D9FF] text-messages"
                                                                                onclick="changejobDetailPage(0)">
                                                                                1
                                                                            </button>
                                                                        </div>
                                                                        <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changejobDetailPage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <input
                                                                        class="jobDetail-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                        type="text" placeholder="Səhifə" />
                                                                    <a href="#"
                                                                        class="jobDetail-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="bildirisler"  class="main-tab-content hidden">
                                        <div
                                            class="flex flex-col gap-6 w-full justify-center items-center h-full min-h-screen bg-sidebar-bg my-3 rounded-lg">
                                            <div>
                                                <img src="/images/notifications/notificationLogo.svg"
                                                    alt="notificationLogo" />
                                            </div>
                                            <div class="text-messages text-[13px] font-medium">
                                                Müəssisəyə aid bildiriş tapılmadı
                                            </div>
                                        </div>
                                    </div>

                                    <div id="rekvizitler" class="main-tab-content hidden">
                                        <div id="rekvizitCount"
                                            class="flex justify-between items-center py-[17px] border-b-[.5px] border-stroke">
                                            <div>Rekvizitlər ( <%= recordsTotal %> )</div>
                                            <button onclick="toggleNewRekvizit('add')"
                                                class="text-primary-text-color-dark text-[13px] px-3 py-1 bg-primary hover:bg-hover-button rounded-full cursor-pointer">
                                                <div class="icon stratis-plus-02 text-xs"></div>
                                                Rekvizit əlavə et
                                            </button>
                                        </div>
                                        <div class="flex gap-3 w-[100%] py-3">
                                            <% ( rekvizitler ?? [] )?.forEach(item => {%>
                                                <!-- <input type="hidden" name="_csrf" id="rekvizitCsrf" value="<%= csrfToken %>"> -->
                                            <div class="flex w-[50%] relative">
                                                <div class="absolute top-2 right-2 flex items-center gap-2">
                                                    <button onclick="toggleNewRekvizit('edit','<%= item._id%>')"
                                                        class="flex gap-1 items-center text-xs text-messages hover:bg-[#F6D9FF] px-3 py-[3px] rounded-full hover:cursor-pointer">
                                                        <div class="icon stratis-edit-03"></div>
                                                        Redaktə et
                                                    </button>
                                                    <button onclick="toggleDeleteModal('<%= item._id %>')"
                                                        class="w-7 h-7 cursor-pointer rounded-lg hover:bg-error-hover">
                                                        <!-- Trash icon (Heroicons və ya lucide-react istifadə edə bilərsən) -->
                                                        <div class="icon stratis-trash-02 text-xs text-error"></div>
                                                    </button>
                                                </div>
                                                <!-- Kartlar -->
                                                <div
                                                    class="flex-1 bg-[#FAFAFA] dark:bg-side-bar-bg-dark rounded-l-[12px] p-5 flex flex-col gap-3">
                                                    <div
                                                        class="text-[11px] font-medium text-[#1D222B] dark:text-[#FFFFFF] opacity-65 mt-3">
                                                        Şirkətin adı
                                                        
                                                    </div>
                                                    <div
                                                        class="text-[13px] text-[#1D222B] dark:text-[#FFFFFF] font-semibold">
                                                       <%= item.sirket_name%>
                                                    </div>

                                                    <div
                                                        class="text-[11px] font-medium text-[#1D222B] dark:text-[#FFFFFF] opacity-65">
                                                        Bankın adı
                                                    </div>
                                                    <div
                                                        class="text-[13px] text-[#1D222B] dark:text-[#FFFFFF] font-semibold">
                                                        <%= item.bank_info.bank_name%>
                                                    </div>
                                                    <div
                                                        class="text-[11px] font-medium text-messages dark:text-[#FFFFFF] opacity-65">
                                                        Swift
                                                    </div>
                                                    <div
                                                        class="text-[13px] text-[#1D222B] dark:text-[#FFFFFF] font-semibols">
                                                        <%= item.bank_info.swift%>
                                                    </div>
                                                    <div
                                                        class="text-[11px] font-medium text-[#1D222B] dark:text-[#FFFFFF] opacity-65">
                                                        Hesablaşma hesabı
                                                    </div>
                                                    <div
                                                        class="text-[13px] text-[#1D222B] font-semibold dark:text-[#FFFFFF] break-all">
                                                        <%= item.bank_info.settlement_account %>
                                                    </div>
                                                </div>
                                             
                                                <div
                                                    class="flex-1 gap-5 bg-[#FAFAFA] dark:bg-side-bar-bg-dark rounded-r-[12px] p-5 flex flex-col">
                                                    <div
                                                        class="border-l-[0.5px] flex flex-col gap-1.5 border-[#0000001A] pl-3 mt-3">
                                                        <div
                                                            class="text-[11px] font-medium text-messages dark:text-[#FFFFFF] opacity-65">
                                                            Hüquqi ünvan
                                                        </div>
                                                        <div
                                                            class="text-[13px] font-semibold dark:text-[#FFFFFF] text-messages">
                                                            <%= item.huquqi_unvan %>
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="border-l-[0.5px] flex flex-col gap-1.5 border-[#0000001A] pl-3">
                                                        <div
                                                            class="text-[11px] font-medium text-messages dark:text-[#FFFFFF] opacity-65">
                                                            Bankın kodu
                                                        </div>
                                                        <div
                                                            class="text-[13px] font-semibold text-messages dark:text-[#FFFFFF]">
                                                            <%= item.bank_info.bank_code %>
                                                        </div>
                                                    </div>

                                                    <div
                                                        class="border-l-[0.5px] flex-col flex gap-1.5 border-[#0000001A] pl-3">
                                                        <div
                                                            class="text-[11px] font-medium text-messages dark:text-[#FFFFFF] opacity-65">
                                                            Müxbir hesabı
                                                        </div>
                                                        <div
                                                            class="text-[13px] font-semibold text-messages dark:text-[#FFFFFF]">
                                                            <%= item.bank_info.muxbir_hesabi %>
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="border-l-[0.5px] flex gap-1.5 flex-col border-[#0000001A] pl-3">
                                                        <div
                                                            class="text-[11px] font-medium text-messages dark:text-[#FFFFFF] opacity-65">
                                                            VÖEN
                                                        </div>
                                                        <div
                                                            class="text-[13px] font-semibold text-messages dark:text-[#FFFFFF]">
                                                            <%= item.voen%>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <% })%>
                                          
                                        </div>
                                    </div>

                                    <div id="muqavileler" class="main-tab-content hidden">
                                        <div
                                            class="pb-3 flex gap-3 items-center justify-between border-b-[.5px] border-stroke dark:border-[#FFFFFF1A] mt-[15px]">
                                            <div id="muqavilelerCounts"
                                                class="whitespace-nowrap text-[15px] text-[#1D222B] font-medium dark:text-white">
                                                Müqavilələr ( 0 )
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <div
                                                    class="relative flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                    <input id="contractsSearch" type="text" placeholder="Search..."
                                                        class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                    <div class="absolute right-3">
                                                        <div
                                                            class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="flex items-center justify-center w-[92px] h-[34px] bg-white dark:bg-transparent border-[1px] border-[#DBE4E8] dark:border-surface-variant-dark rounded-full">
                                                    <button onclick="openContractsTableGrid4()"
                                                        class="flex-1 flex items-center justify-center h-full bg-[#F7F9FB] dark:bg-transparent text-messages dark:text-on-primary-dark rounded-full">
                                                        <div class="icon stratis-grid-01 cursor-pointer"></div>
                                                    </button>
                                                    <button onclick="openContractsTableGrid2()"
                                                        class="flex-1 flex items-center justify-center h-full">
                                                        <div class="icon stratis-column-horizontal-01 cursor-pointer">
                                                        </div>
                                                    </button>
                                                </div>
                                                <div id="reloadPage"
                                                    class="w-[155px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                    <span  class="font-medium text-[13px]">Səhifəni yenilə</span>
                                                    <span
                                                        class="icon stratis-arrow-refresh-04 text-messages dark:text-primary-text-color-dark"></span>
                                                </div>
                                                <div onclick="openContractsFilterModal()"
                                                    class="w-[103px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                    <a href="#"
                                                        class="icon stratis-filter text-messages dark:text-primary-text-color-dark mt-[2.5px]"></a>
                                                    <a href="#" class="">Filter</a>
                                                </div>
                                                <div onclick="toggleFileUploadModal()"
                                                    class="w-[176px] cursor-pointer border border-surface-variant rounded-full flex items-center justify-center gap-2 text-[13px] bg-primary hover:bg-hover-button text-on-primary font-medium py-[6.5px] px-[18px]">
                                                    <div class="icon stratis-plus-02 text-xs"></div>
                                                    <span class="">Müqavilə əlavə et</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            class="w-full bg-white dark:bg-body-bg-dark rounded-b-[16px] py-2 flex flex-col gap-1">
                                            <!-- Grid Table -->
                                            <div id="contractsGrid4" class="">
                                                <!-- buraya 4 kolonlu table HTML yazılır -->
                                                <table id="contractsTable" class="table-fixed border-collapse w-full">
                                                    <tbody id="contractsTableBody" class="grid grid-cols-4 gap-3">
                                                    </tbody>
                                                </table>
                                                <div class="pt-3">
                                                    <div
                                                        class="w-full bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] py-5 px-6 flex flex-col gap-3">
                                                        <div class="py-2.5 flex items-center justify-between">
                                                            <div class="text-[13px] flex items-center gap-2">
                                                                <span
                                                                    class="font-normal opacity-65 dark:text-secondary-text-color-dark">Səhifə
                                                                    sayı:</span>
                                                                <span id="contractsTablePageCount"
                                                                    class="font-medium dark:text-primary-text-color-dark">1
                                                                    / 49</span>
                                                            </div>
                                                            <div class="max-w-[584px] flex items-center gap-5">
                                                                <div>
                                                                    <div id="contractsPagination"
                                                                        class="flex items-center text-[13px]"></div>
                                                                </div>
                                                                <div>
                                                                    <input
                                                                        class="contracts-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                        type="text" placeholder="Səhifə" />
                                                                    <a href="#"
                                                                        class="contracts-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Horizontal Table -->
                                            <div id="contractsGrid2" class="hidden">
                                                <!-- buraya 4 kolonlu table HTML yazılır -->
                                                <table id="contractsGridTable"
                                                    class="table-fixed border-collapse w-full">
                                                    <thead class="border-none pb-0.5">
                                                        <tr
                                                            class="bg-container-2 dark:bg-container-2-dark border-none text-xs text-tertiary-text dark:text-tertiary-text-color-dark font-base">
                                                            <th
                                                                class="w-1/2 border-r-[.5px] border-r-stroke dark:border-[#FFFFFF1A] px-4 py-2 filtering">
                                                                Müqavilə adı
                                                            </th>
                                                            <th
                                                                class="w-1/2 border-r-[.5px] border-r-stroke dark:border-[#FFFFFF1A] px-4 py-2 filtering">
                                                                Yüklənmə tarixi
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                                <div class="pt-3">
                                                    <div
                                                        class="w-full bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] py-5 px-6 flex flex-col gap-3">
                                                        <div class="py-2.5 flex items-center justify-between">
                                                            <div class="text-[13px] flex items-center gap-2">
                                                                <span
                                                                    class="font-normal opacity-65 dark:text-secondary-text-color-dark">Səhifə
                                                                    sayı:</span>
                                                                <span id="contractsGridTablePageCount"
                                                                    class="font-medium dark:text-primary-text-color-dark">1
                                                                    / 49</span>
                                                            </div>
                                                            <div class="max-w-[584px] flex items-center gap-5">
                                                                <div>
                                                                    <div id="contractsGridTablePagination"
                                                                        class="flex items-center text-[13px]"></div>
                                                                </div>
                                                                <div>
                                                                    <input
                                                                        class="contracts-gridtable-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px] focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300"
                                                                        type="text" placeholder="Səhifə" />
                                                                    <a href="#"
                                                                        class="contracts-gridtable-go-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="emeliyyatlar" class="main-tab-content hidden">
                                        <div id="clickable-card" class="py-3">
                                            <div
                                                class="flex flex-col items-center justify-center px-6 py-13 gap-2 w-[400px] rounded-lg bg-container-2 cursor-pointer">
                                                <div class="iconex iconex-receipt-1 w-6 h-6"></div>
                                                <div class="text-[17px] text-messages text-semibold">
                                                    Hesablaşma 
                                                </div>
                                                <di class="text-[13px] text-secondary-text font-normal">Müəssisənin
                                                    əməliyyatlarını görə bilərsiniz
                                                </di>
                                            </div>
                                        </div>

                                        <div id="backButton"
                                            class="flex items-center gap-3 cursor-pointer py-3 mt-3 border-b-[.5px] border-stroke">
                                            <!-- Geri qayıtma düyməsi -->
                                            <button id="backArrow" class="hidden text-messages">
                                                <div class="icon stratis-arrow-left text-xs cursor-pointer"></div>
                                            </button>
                                            <div id="modalTitle" class="text-[15px] font-medium">
                                                <!-- title goes here -->
                                            </div>
                                        </div>

                                        <!-- İllər Siyahısı üçün Container (gizlidir) -->
                                        <div id="yearsContainer" class="hidden">
                                            <div id="years" class="flex flex-wrap flex-shrink py-5">
                                            </div>
                                        </div>

                                        <!-- Aylar Siyahısı üçün Container (gizlidir) -->
                                        <div id="monthsContainer" class="hidden">
                                            <div id="months" class="flex flex-wrap flex-shrink py-5">
                                                <!-- Ay kartları bura əlavə ediləcək -->
                                            </div>
                                        </div>

                                        <div id="tableContainer" class="hidden">
                                            <div class="flex flex-col gap-3 mb-3">
                                                <div
                                                    class="py-3 flex items-center justify-between border-b-[.5px] border-stroke dark:border-[#FFFFFF1A] mt-[15px]">
                                                    <div class="flex rounded-lg">
                                                        <!-- Seçilmiş dəyərlərin göstəriləcəyi hissə -->
                                                        <div id="selectedValues"
                                                            class="hidden text-[13px] font-medium py-2 bg-container-2 rounded-lg">
                                                            <!-- Dəyərlər bura dinamik əlavə ediləcək -->
                                                        </div>
                                                    </div>
                                                    <div class="flex items-center gap-2">
                                                        <div
                                                            class="relative font-normal flex items-center w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                            <input id="emeliyyatlarSearch" type="text"
                                                                placeholder="Axtarış..."
                                                                class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                            <div class="absolute right-3">
                                                                <div
                                                                    class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div id="reloadPage"
                                                            class="w-[155px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                            <span >Səhifəni yenilə</span>
                                                            <span
                                                                class="icon stratis-arrow-refresh-04 text-messages dark:text-primary-text-color-dark"></span>
                                                        </div>
                                                        <div onclick="openEmeliyyatlarFilterModal()"
                                                            class="w-[103px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                            <span
                                                                class="icon stratis-filter text-messages dark:text-primary-text-color-dark mt-[2.5px]"></span>
                                                            <span>Filterlə</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <table id="emeliyyatlarTable" class="border-collapse emeliyyatlar-table">
                                                <thead>
                                                    <tr
                                                        class="emeliyyatlar-table-header-row bg-container-2 table-fixed dark:bg-container-2-dark border-none text-[12px] text-secondary-text dark:text-secondary-text-color-dark font-normal">
                                                        <th class="whitespace-nowrap rounded-l-lg filtering">İnvoys 
                                                            nömrəsi</th>
                                                        <th class="whitespace-nowrap filtering">Tranzaksiya sayı</th>
                                                        <th class="whitespace-nowrap filtering">Məbləğ</th>
                                                        <th class="whitespace-nowrap filtering">Komissiya</th>
                                                        <th class="whitespace-nowrap filtering">Yekun məbləğ</th>
                                                        <th class="whitespace-nowrap filtering">Hesablaşma tarixi</th>
                                                        <th class="whitespace-nowrap filtering rounded-r-lg">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>

                                                </tbody>
                                            </table>
                                            <div class="pt-2">
                                                <div
                                                    class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                    <div class="py-5 flex items-center justify-between">
                                                        <div class="text-[13px] flex items-center gap-2">
                                                            <span class="font-normal opacity-65">Səhifə sayı:</span>
                                                            <span id="emeliyyatlarPageCount" class="font-medium">1 /
                                                                1</span>
                                                        </div>
                                                        <div class="flex items-center gap-5">
                                                            <div>
                                                                <div id="emeliyyatlarPagination"
                                                                    class="flex items-center">
                                                                    <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                        onclick="changeEmeliyyatlarPage(0)">
                                                                        <div
                                                                            class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                        </div>
                                                                    </div>
                                                                    <div class="flex gap-2">
                                                                        <button class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages
                                bg-[#F6D9FF] text-messages" onclick="changePage(0)">1</button>
                                                                    </div>
                                                                    <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                        onclick="changeEmeliyyatlarPage(0)">
                                                                        <div
                                                                            class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <input class="emeliyyatlar-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px]
                      focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
                      active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)]
                      transition-all ease-out duration-300" type="text" placeholder="Səhifə" />
                                                                <a href="#"
                                                                    class="go-emeliyyatlar-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="companiesContainer" class="hidden">
                                            <div class="flex flex-col gap-3">
                                                <div onclick="window.location.href='../muessise/hesablasmaDetails.html'"
                                                    class="bg-sidebar-bg mt-3 p-3 rounded-lg h-[69px]">
                                                    <div class="flex gap-3 text-message b-2 w-full">
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">İnvoys nömrəsi
                                                            </p>
                                                            <p
                                                                class="text-[13px] font-medium overflow-hidden text-ellipsis">
                                                                MINV-XXXXXXXXXX</p>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Şirkət sayı</p>
                                                            <p class="text-[13px] font-medium">22</p>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Tranzaksiya sayı
                                                            </p>
                                                            <p class="text-[13px] font-medium">104</p>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Məbləğ</p>
                                                            <p class="text-[13px] font-medium">102.78 ₼</p>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Komissiya</p>
                                                            <p class="text-[13px] font-medium">2.50 ₼</p>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Yekun məbləğ</p>
                                                            <p class="text-[13px] font-medium">105.28</p>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis min-w-0">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Hesablaşma tarixi
                                                            </p>
                                                            <p class="text-[13px] font-medium">01.12.2023 - 16.12.2023
                                                            </p>
                                                        </div>

                                                        <!-- ✅ Bura shrink olmur -->
                                                        <div
                                                            class="flex-shrink-0 flex items-center justify-start bg-container-2 dark:bg-container-2-dark px-3 py-[5px] rounded-full whitespace-nowrap overflow-hidden text-ellipsis">
                                                            <span
                                                                class="w-[6px] h-[6px] rounded-full bg-[#4FC3F7] shrink-0 mr-2"></span>
                                                            <span
                                                                class="text-[13px] text-messages dark:text-primary-text-color-dark font-medium">Aktiv</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="flex items-center justify-between text-messages border-b-[.5px] border-stroke py-3">
                                                    <div id="backToTableContainer"
                                                        class="flex items-center gap-2 cursor-pointer text-[15px]">
                                                        <div class="icon stratis-arrow-left-sm text-xs"></div>
                                                        Xidmət verdiyi şirkətlər (80)
                                                    </div>
                                                    <div class="flex items-center gap-2">
                                                        <div
                                                            class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                            <input id="companiesSearch" type="text"
                                                                placeholder="Search..."
                                                                class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                            <div class="absolute right-3">
                                                                <div
                                                                    class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div
                                                            id="reloadPage"
                                                            class="w-[155px] cursor-pointer h-[34px] border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                            <span class="text-[13px] font-medium">Səhifəni
                                                                yenilə</span>
                                                            <span
                                                                class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                        </div>
                                                        <div onclick="openCompaniesFilterModal()"
                                                            class="w-[96px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                            <div
                                                                class="icon stratis-filter text-messages dark:text-primary-text-color-dark mt-[2.5px]">
                                                            </div>
                                                            <span>Filter</span>
                                                        </div>
                                                        <div
                                                            class="w-[130px] cursor-pointer border border-surface-variant rounded-full flex items-center justify-center gap-2 text-[13px] text-messages hover:text-focus font-medium py-[6.5px] px-[10px] transition-all">
                                                            <img class="w-5"
                                                                src="/images/Avankart/muessise/pdfIcon.svg"
                                                                alt="PDF">
                                                            <span>özsüt.pdf</span>
                                                            <img src="/icons/download.svg" alt="">
                                                        </div>
                                                    </div>
                                                </div>
                                                <table id="companiesTable" class="border-collapse emeliyyatlar-table">
                                                    <thead>
                                                        <tr
                                                            class="emeliyyatlar-table-header-row bg-container-2 table-fixed dark:bg-container-2-dark border-none text-[12px] text-secondary-text dark:text-secondary-text-color-dark font-normal">
                                                            <th class="whitespace-nowrap rounded-l-lg filtering">Şirkət
                                                            </th>
                                                            <th class="whitespace-nowrap filtering">Tranzaksiya sayı
                                                            </th>
                                                            <th class="whitespace-nowrap rounded-r-lg filtering">Məbləğ
                                                            </th>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                                <div class="pt-2">
                                                    <div
                                                        class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                        <div class="py-5 flex items-center justify-between">
                                                            <div class="text-[13px] flex items-center gap-2">
                                                                <span class="font-normal opacity-65">Səhifə sayı:</span>
                                                                <span id="companiesPageCount" class="font-medium">1 /
                                                                    1</span>
                                                            </div>
                                                            <div class="flex items-center gap-5">
                                                                <div>
                                                                    <div id="companiesPagination"
                                                                        class="flex items-center">
                                                                        <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changeCompaniesPage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                        <div class="flex gap-2">
                                                                            <button class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages
                                 bg-[#F6D9FF] text-messages" onclick="changeCompaniesPage(0)">1</button>
                                                                        </div>
                                                                        <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changeCompaniesPage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <input class="companies-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px]
                      focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
                      active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)]
                      transition-all ease-out duration-300" type="text" placeholder="Səhifə" />
                                                                    <a href="#"
                                                                        class="go-companies-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="transactionContainer" class="hidden">
                                            <div class="flex flex-col gap-3">
                                                <div class="bg-sidebar-bg mt-3 p-3 rounded-lg h-[69px]">
                                                    <div class="flex gap-3 text-message b-2 w-full">
                                                        <div class="border-r-[0.5px] border-[#0000001A] w-1/3">
                                                            <div class="flex items-center gap-2.5">
                                                                <div
                                                                    class="bg-table-hover w-[40px] h-[40px] rounded-[50%]">
                                                                    <div class="p-2">
                                                                        <img src="/images/Avankart/Sirket/Pasha.svg"
                                                                            alt="Logo">
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <div class="text-[13px] font-medium">Pasha Holding
                                                                    </div>
                                                                    <div
                                                                        class="text-[11px] text-messages opacity-65 font-normal">
                                                                        ID: <span class="opacity-100">CM-XXXXXXXX</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="border-r-[0.5px] border-[#0000001A] whitespace-nowrap pr-4 overflow-hidden text-ellipsis w-1/3">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Tranzaksiya sayı
                                                            </p>
                                                            <p class="text-[13px] font-medium">104</p>
                                                        </div>
                                                        <div
                                                            class="whitespace-nowrap pr-4 overflow-hidden text-ellipsis w-1/3">
                                                            <p class="text-[11px] opacity-65 pb-[6px]">Məbləğ</p>
                                                            <p class="text-[13px] font-medium">102.78 ₼</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="flex items-center justify-between text-messages border-b-[.5px] border-stroke py-3">
                                                    <div id="backToCompaniesContainer"
                                                        class="flex items-center gap-2 cursor-pointer text-[15px]">
                                                        <div class="icon stratis-arrow-left-sm text-xs"></div>
                                                        Tranzaksiya (80)
                                                    </div>
                                                    <div class="flex items-center gap-2">
                                                        <div
                                                            class="relative font-normal flex items-center max-w-[237px] border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                                                            <input id="transactionsSearch" type="text"
                                                                placeholder="Search..."
                                                                class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                                                            <div class="absolute right-3">
                                                                <div
                                                                    class="icon stratis-search-02 dark:text-primary-text-color-dark">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="w-[155px] h-[34px] border-[1px] border-surface-variant rounded-[100px] flex items-center justify-between gap-2 pl-[18px] pr-[20px] hover:text-primary dark:bg-table-hover-dark dark:border-on-surface-variant dark:text-white">
                                                            <span class="text-[13px] font-medium">Səhifəni
                                                                yenilə</span>
                                                            <span
                                                                class="icon stratis-arrow-refresh-04 !w-[12px] !h-[12px] text-messages hover:text-messages dark:text-white"></span>
                                                        </div>
                                                        <div onclick="openTransactionsFilterModal()"
                                                            class="w-[96px] cursor-pointer border border-surface-variant dark:border-surface-variant-dark rounded-full flex items-center justify-center gap-2 text-[13px] text-messages dark:text-primary-text-color-dark hover:text-focus dark:hover:text-focus-color-dark font-medium py-[6.5px] px-[18px]">
                                                            <div
                                                                class="icon stratis-filter text-messages dark:text-primary-text-color-dark mt-[2.5px]">
                                                            </div>
                                                            <span>Filter</span>
                                                        </div>
                                                        <div
                                                            class="w-[130px] cursor-pointer border border-surface-variant rounded-full flex items-center justify-center gap-2 text-[13px] text-messages hover:text-focus font-medium py-[6.5px] px-[10px] transition-all">
                                                            <img class="w-5"
                                                                src="/images/Avankart/muessise/pdfIcon.svg"
                                                                alt="PDF">
                                                            <span>özsüt.pdf</span>
                                                            <img src="/icons/download.svg" alt="">
                                                        </div>
                                                    </div>
                                                </div>
                                                <table id="transactionsTable"
                                                    class="border-collapse emeliyyatlar-table">
                                                    <thead>
                                                        <tr
                                                            class="emeliyyatlar-table-header-row bg-container-2 table-fixed dark:bg-container-2-dark border-none text-[12px] text-secondary-text dark:text-secondary-text-color-dark font-normal">
                                                            <th class="whitespace-nowrap rounded-l-lg filtering">
                                                                İstifadəçi</th>
                                                            <th class="whitespace-nowrap filtering">Tranzaksiya ID</th>
                                                            <th class="whitespace-nowrap filtering">Kart kateqoriyası
                                                            </th>
                                                            <th class="whitespace-nowrap filtering">Məbləğ (AZN)</th>
                                                            <th class="whitespace-nowrap filtering">Məkan</th>
                                                            <th class="whitespace-nowrap rounded-r-lg filtering">Tarix
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                                <div class="pt-2">
                                                    <div
                                                        class="bg-sidebar-bg dark:bg-side-bar-bg-dark rounded-t-[8px] px-6 flex flex-col gap-3">
                                                        <div class="py-5 flex items-center justify-between">
                                                            <div class="text-[13px] flex items-center gap-2">
                                                                <span class="font-normal opacity-65">Səhifə sayı:</span>
                                                                <span id="transactionsPageCount" class="font-medium">1 /
                                                                    1</span>
                                                            </div>
                                                            <div class="flex items-center gap-5">
                                                                <div>
                                                                    <div id="transactionsPagination"
                                                                        class="flex items-center">
                                                                        <div class="flex items-center justify-center pr-[42px] h-8 ms-0 leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changeTransactionsPage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-left !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                        <div class="flex gap-2">
                                                                            <button class="cursor-pointer w-10 text-[13px] h-10 rounded-[8px] hover:text-messages
                                bg-[#F6D9FF] text-messages" onclick="changeTransactionsPage(0)">1</button>
                                                                        </div>
                                                                        <div class="flex items-center justify-center h-8 ms-0 pl-[42px] leading-tight opacity-50 cursor-not-allowed"
                                                                            onclick="changeTransactionsPage(0)">
                                                                            <div
                                                                                class="icon stratis-chevron-right !h-[12px] !w-[7px]">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <input class="transactions-page-input w-[63px] h-[32px] text-[12px] text-center text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:text-[#636B6F] font-normal bg-menu dark:bg-menu-dark hover:bg-input-hover dark:hover:bg-input-hover-dark border border-stroke dark:border-[#FFFFFF1A] rounded-[8px]
                      focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
                      active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)]
                      transition-all ease-out duration-300" type="text" placeholder="Səhifə" />
                                                                    <a href="#"
                                                                        class="go-transactions-button text-[13px] text-body-bg dark:text-primary-text-color-dark font-medium bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark rounded-[8px] py-[6.5px] px-[18px]">GO</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="sorgular" class="main-tab-content hidden">
                                        <div class="table border-x border-dashed border-stroke w-full min-w-full"
                                            style="table-layout: fixed">
                                            <div class="table-row border-b border-dashed border-stroke">
                                                <div id="column-Qaralama"
                                                    class="table-cell border-r border-dashed border-stroke px-2 py-3 align-top">
                                                </div>
                                                <div id="column-Baxılır"
                                                    class="table-cell border-r border-dashed border-stroke px-2 py-3 align-top">
                                                </div>
                                                <div id="column-Həll-olundu"
                                                    class="table-cell border-r border-dashed border-stroke px-2 py-3 align-top">
                                                </div>
                                                <div id="column-Rədd-edildi" class="table-cell px-2 py-3 align-top">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--- popups --->

                <!-- Dashboard popups -->
    <div id="yearsModal" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <div
            class="border-3 border-stroke dark:border-stroke-color-dark bg-white dark:bg-side-bar-item-dark rounded-xl w-[509px] max-w-full shadow-lg relative">
            <!-- Modal Header -->
            <div
                class="flex justify-between items-center border-b border-stroke dark:border-surface-variant-dark px-[18px] py-3">
                <h2 class="text-[16px] font-semibold text-black dark:text-white">
                    İllər
                </h2>
                <button onclick="closeYearsModal()" class="text-[24px] cursor-pointer text-gray-600 dark:text-white">
                    ×
                </button>
            </div>
            <div
                class="relative my-3 mx-3 flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                <input id="customSearch" type="text" placeholder="Search..."
                    class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                <div class="absolute right-3">
                    <div class="icon stratis-search-02 dark:text-primary-text-color-dark"></div>
                </div>
            </div>

            <!-- List -->
            <ul class="divide-y divide-stroke dark:divide-surface-variant-dark text-sm my-3 mx-3">
                <label for="checkbox1" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox1" type="checkbox" value="2019"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2019
                    </div>
                </label>
                <label for="checkbox2" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox2" type="checkbox" value="2020"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2020
                    </div>
                </label>
                <label for="checkbox3" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox3" type="checkbox" value="2021"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2021
                    </div>
                </label>
                <label for="checkbox4" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox4" type="checkbox" value="2022"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2022
                    </div>
                </label>
                <label for="checkbox5" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox5" type="checkbox" value="2023"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2023
                    </div>
                </label>
                <label for="checkbox6" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox6" type="checkbox" value="2024"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2024
                    </div>
                </label>
                <label for="checkbox7" class="block py-2 flex items-center gap-2 cursor-pointer">
                    <input id="checkbox7" type="checkbox" value="2025"
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" />
                    <div class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        2025
                    </div>
                </label>
            </ul>

            <!-- Footer buttons -->
            <div class="flex justify-end gap-2 border-t border-stroke dark:border-surface-variant-dark px-6 py-5">
                <button onclick="closeYearsModal()"
                    class="cursor-pointer bg-surface-bright dark:bg-surface-bright-dark text-on-surface-variant dark:text-on-surface-variant-dark text-[13px] font-medium py-2 px-4 rounded-full">
                    Bağla
                </button>
                <button onclick="clearFilter()"
                    class="cursor-pointer bg-surface-bright dark:bg-surface-bright-dark text-on-surface-variant dark:text-on-surface-variant-dark text-[13px] font-medium py-2 px-4 rounded-full">
                    Filterləri təmizlə
                </button>
                <button id="filterButtonIller"
                    class="cursor-pointer bg-primary dark:bg-primary-dark text-on-primary dark:text-on-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark text-[13px] font-medium py-2 px-4 rounded-full">
                    Filterlə
                </button>
            </div>
        </div>
    </div>

    <div id="kartlarModal" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <!-- Modal Content -->
        <div
            class="border-3 border-stroke dark:border-stroke-color-dark bg-white dark:bg-side-bar-item-dark rounded-xl w-[509px] max-w-full shadow-lg relative">
            <!-- Modal Header -->
            <div
                class="flex justify-between items-center border-b border-stroke dark:border-surface-variant-dark px-[18px] py-3">
                <h2 class="text-[16px] font-semibold text-black dark:text-white">
                    kartlar
                </h2>
                <button onclick="closeKartlarModal()" class="text-[24px] cursor-pointer text-gray-600 dark:text-white">
                    ×
                </button>
            </div>
            <div
                class="relative my-3 mx-3 flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                <input id="customSearch4" type="text" placeholder="Search..."
                    class="w-full h-full bg-transparent border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                <div class="absolute right-3">
                    <div class="icon stratis-search-02 dark:text-primary-text-color-dark"></div>
                </div>
            </div>

            <!-- List -->
            <ul class="divide-y divide-stroke dark:divide-surface-variant-dark text-sm my-3 mx-3">
                <% if (cards && cards.length > 0) { %>
                    <% cards.forEach((kart, index) => { %>
                    <label for="checkboxKart<%= index + 1 %>" class="block py-2 flex items-center gap-2 cursor-pointer">
                        <input 
                        id="checkboxKart<%= index + 1 %>" 
                        type="checkbox" 
                        value="<%= kart.name %>" 
                        data-id="<%= kart._id %>" 
                        class="rounded-[2px] w-[18px] h-[18px] border-[1px] border-surface-variant text-primary focus:outline-none focus:ring-0 focus:shadow-none hover:bg-surface-container-low disabled:bg-switch dark:bg-[var(--color-table-hover-dark)] dark:border-[#40484C]" 
                        />
                        <div id="<%= kart._id %>" class="text-[13px] text-[#1D222B] pb-[4px] dark:text-[#FFFFFF]">
                        <%= kart.name %>
                        </div>
                    </label>
                    <% }) %>
                <% } else { %>
                    <!-- <li class="text-gray-400 text-[13px] py-2">Heç bir kart tapılmadı.</li> -->
                <% } %>
            </ul>

            <!-- Footer buttons -->
            <div class="flex justify-end gap-2 border-t border-stroke dark:border-surface-variant-dark px-6 py-5">
                <button onclick="closeKartlarModal()"
                    class="cursor-pointer bg-surface-bright dark:bg-surface-bright-dark text-on-surface-variant dark:text-on-surface-variant-dark text-[13px] font-medium py-2 px-4 rounded-full">
                    Bağla
                </button>
                <button onclick="clearKartlarFilter()"
                    class="cursor-pointer bg-surface-bright dark:bg-surface-bright-dark text-on-surface-variant dark:text-on-surface-variant-dark text-[13px] font-medium py-2 px-4 rounded-full">
                    Filterləri təmizlə
                </button>
                <button id="filterButton"
                    class="cursor-pointer bg-primary dark:bg-primary-dark text-on-primary dark:text-on-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark text-[13px] font-medium py-2 px-4 rounded-full">
                    Filterlə
                </button>
            </div>
        </div>
    </div>

    <div id="dateModal" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <div onclick="closeDateModal()"></div>
        <div
            class="border-3 border-stroke dark:border-[#FFFFFF1A] w-[450px] bg-sidebar-item dark:bg-side-bar-item-dark fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-100 shadow-xl rounded-[12px] max-h-[100vh]">
            <div class="p-6">
                <div class="relative mb-3">
                    <div class="flex flex-col gap-1">
                        <h3 class="text-[15px] font-medium text-messages dark:text-primary-text-color-dark">
                            Tarix əlavə et
                        </h3>
                        <p class="text-[13px] font-normal text-secondary-text dark:text-secondary-text-color-dark">
                            Tarix aralığı qeyd edərək QR kod sayını görə bilərsiniz
                        </p>
                    </div>
                    <div onclick="closeDateModal()" class="w-[18px] h-[18px] absolute right-0 top-0 cursor-pointer">
                        <div class="icon stratis-x-01 text-[12px] text-messages dark:text-primary-text-color-dark">
                        </div>
                    </div>
                </div>
                <div>
                    <form id="dateForm"  >
                        <input type="hidden" name="_csrf"  value="<%= csrfToken %>" />
                        <input type="hidden" name="muessise_id" id="muessiseId" value="<%= newMuessise.muessise_id %>" />
                        <label class="flex flex-col gap-[6px] mb-3">
                            <p class="text-[12px] text-secondary-text dark:text-secondary-text-color-dark font-medium">
                                Tarix aralığı
                            </p>
                            <div onclick="openDatePicker('startDate')" class="relative w-full group">
                                <input id="startDate" type="date"
                                    class="date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                    placeholder="dd/mm/yyyy" name="start_date" />
                                <div
                                    class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                </div>
                            </div>
                            <div
                                class="text-[11px] text-tertiary-text dark:text-tertiary-text-color-dark font-normal flex items-center gap-1">
                                <div class="icon stratis-information-circle-contained"></div>
                                <span>Başlanğıc tarixini qeyd edin</span>
                            </div>
                        </label>
                        <label class="flex flex-col gap-[6px] mb-3">
                            <div onclick="openDatePicker('endDate')" class="relative w-full group">
                                <input id="endDate" type="date"
                                    class="date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                    placeholder="dd/mm/yyyy" name="end_date" />
                                <div
                                    class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                </div>
                            </div>
                            <div
                                class="text-[11px] text-tertiary-text dark:text-tertiary-text-color-dark font-normal flex items-center gap-1">
                                <div class="icon stratis-information-circle-contained"></div>
                                <span>Son tarixi qeyd edin</span>
                            </div>
                        </label>
                        <div class="flex justify-end gap-2 mt-4">
                            <button type="button"
                                class="text-[13px] font-medium py-[6.5px] px-[18px] bg-surface-bright dark:bg-surface-bright-dark text-on-surface-variant dark:text-on-surface-variant-dark rounded-full cursor-pointer"
                                onclick="closeDateModal()">
                                Bağla
                            </button>
                            <button type="button"
                                class="text-[13px] font-medium py-[6.5px] px-[18px] bg-surface-bright dark:bg-surface-bright-dark text-on-surface-variant dark:text-on-surface-variant-dark rounded-full cursor-pointer"
                                onclick="clearDateModalFilters()">
                                Filterləri təmizlə
                            </button>
                            <button type="submit"
                                class="text-[13px] font-medium py-[6.5px] px-[18px] bg-primary dark:bg-primary-dark hover:bg-hover-button dark:hover:bg-hover-button-dark focus:bg-focus dark:focus:bg-focus-color-dark text-on-primary dark:text-on-primary-dark rounded-full cursor-pointer">
                                Əlavə et
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <form id="yeniRekvizitForm"
    data-url="/muessiseler/rekvizitler"
    onsubmit="return false"
     class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
     <input type="hidden" name="_csrf"  value="<%= csrfToken %>" />
     <input type="hidden" name="muessise_id" id="muessiseId" value="<%= newMuessise.muessise_id %>" />
        <div class="bg-menu w-[594px] rounded-lg border-3 border-stroke">
            <div
                class="dark:bg-side-bar-item-dark flex items-center justify-between border-b border-stroke px-6 dark:border-[#FFFFFF1A] pt-[18px] pb-[18px]">
                <div id="rekvizitTitle" class="text-[15px] font-medium dark:text-white">
                    Yeni rekvizit
                </div>
                <div onclick="toggleNewRekvizit()" class="icon stratis-x-02 text-xs cursor-pointer"></div>
            </div>
            <div id="rekvizitPopUp"  class="flex flex-col gap-3 px-6 py-3 overflow-y-auto max-h-[70vh] custom-scroll">
                <!-- Şirkətin adı -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">Şirkətin adı</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input type="text" name="sirket_name"  placeholder="Şirkət adını daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>

                <!-- Bankın adı -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">Bankın adı</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input name="bank_name" type="text" placeholder="Bank adını daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>

                <!-- SWIFT -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">SWIFT</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input name="swift" type="text" placeholder="Bankın SWIFT kodunu daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>

                <!-- Hesablaşma hesabı -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">Hesablaşma hesabı</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input name="hesablasma" type="text" placeholder="İBAN daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>

                <!-- Hüquqi ünvan -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">Hüquqi ünvan</label>
                    <div class="flex items-center">
                        <div
                            class="relative flex-1 items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                            <input type="text"
                                id="huquqiaddress"
                                placeholder="Ünvanı daxil edin"
                                name="huquqi_unvan"
                                class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                            </div>
                        <button type="button"
                            onclick="openMapModal('huquqiaddress','huquqilatlng')"
                            class="ml-3 text-xs font-medium text-messages px-3 py-[2px] hover:bg-[#F6D9FF] rounded-full cursor-pointer">
                            Xəritədən seç
                        </button>
                    </div>
                </div>

                <!-- Bankın kodu -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">Bankın kodu</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input name="bank_kodu" type="text" placeholder="Bankın SWIFT kodunu daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>

                <!-- Mükbir hesabı -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">Müxbir hesabı</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input name="muxbir_hesabi" type="text" placeholder="Müxbir hesabını daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>

                <!-- VÖEN -->
                <div>
                    <label class="block text-xs font-medium text-secondary-text pb-1">VÖEN</label>
                    <div
                        class="relative flex items-center border border-surface-variant dark:border-surface-variant-dark rounded-full overflow-hidden focus-within:border-focus focus-within:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus-within:ring-0 focus-within:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 hover:bg-input-hover dark:hover:bg-input-hover-dark">
                        <input name="voen" type="text" placeholder="Bankın Vöenini daxil edin"
                            class="w-full h-full bg-transparent font-normal border-none focus:outline-none outline-none ring-0 focus:ring-0 text-[13px] text-messages dark:text-primary-text-color-dark placeholder:text-on-surface-variant-dark dark:placeholder:text-[#636B6F]" />
                    </div>
                </div>
            </div>
            <div
                class="flex items-center justify-end gap-3 border-t border-stroke px-6 dark:border-[#FFFFFF1A] pt-[18px] pb-[18px]">
                <button type="button" onclick="toggleNewRekvizit('clear')"
                    class="bg-surface rounded-[50px] text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages dark:bg-surface-bright-dark dark:text-white transition">
                    Ləğv et
                </button>
                <button type="submit"
                    onclick="submitForm('yeniRekvizit')"
                    class="bg-primary hover:bg-hover-button rounded-[50px] text-white text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:bg-[#4CAF1E] transition">
                    Yadda saxla
                </button>
            </div>
        </div>
    </form >
            <div id="mapModal" class="hidden">
        <!-- Arxa fon -->
        <div onclick="closeMapModal()" class="fixed inset-0 bg-black/40" style="z-index: 999"></div>

        <!-- Modal content -->
        <div
            style="z-index: 9999"
            class="w-[450px] h-[500px] fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white shadow-xl rounded-[12px] p-3"
        >
            <div class="w-full h-[420px]" id="map"></div>
            <div class="flex justify-end mt-3">
            <button
                onclick="selectCoords()"
                class="px-4 py-1 text-sm bg-purple-600 text-white rounded-full hover:bg-purple-700"
            >
                Seç
            </button>
            </div>
        </div>
        </div>


    <div id="filterPop" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <div
            class="w-[450px] font-poppins dark:bg-menu-dark text-messages dark:text-primary-text-color-dark border-[#0000001A] dark:border-[#FFFFFF1A] border-[3px] shadow-[0px_0px_30px_0px_rgba(0,0,0,0.05)] rounded-2xl bg-white z-101 fixed top-[50%] left-[50%] transform -translate-y-1/2 -translate-x-1/2 p-6">
            <form onsubmit="return false;" data-url="/hesablashmalar/datatable" id="filterForm">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                <div>
                    <div class="flex items-center justify-between">
                        <div class="text-[15px] font-medium">Filter</div>
                        <div onclick="openFilterModal()" class="icon stratis-x-02 text-xs cursor-pointer dark:hidden">
                        </div>
                    </div>
                </div>
                <div class="flex flex-col gap-2 pb-5">
                    <div>
                        <div class="relative">
                            <span
                                class="text-[12px] text-tertiary-text dark:text-tertiary-text-color-dark font-medium">İşçilər</span>
                            <button id="dropdownDefaultButton_users"
                                class="cursor-pointer font-normal font-poppins rounded-2xl text-[12px] px-5 py-2.5 text-center flex items-center justify-between border border-[#0000001A] w-full h-[34px] mt-1 hover:bg-container-2 dark:bg-[#161E22] dark:text-white dark:border-[#FFFFFF1A] dark:hover:bg-[#1F282C]"
                                type="button" onclick="toggleDropdown_users()">
                                Seçim edin
                                <div>
                                    <img src="/images/Avankart/Sirket/chevron-down.svg" alt=""
                                        class="w-[15px] h-[13px] dark:invert" />
                                </div>
                            </button>
                            <div id="dropdown_users"
                                class="hidden absolute mt-2 w-[402px] max-h-[200px] overflow-y-auto overflow-x-hidden custom-scroll bg-white border-[.5px] border-stroke rounded-lg shadow z-50 dark:bg-[#161E22] dark:border-[#FFFFFF1A] visible">
                                <label for="istifadeci-ramin-orucov"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="istifadeci-ramin-orucov" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Ramin Orucov Yaşar</span>
                                </label>

                                <label for="istifadeci-tofiq-aliyev"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="istifadeci-tofiq-aliyev" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Tofiq Əliyev</span>
                                </label>

                                <label for="istifadeci-isa-sadiqli"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="istifadeci-isa-sadiqli" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">İsa Sadıqlı</span>
                                </label>

                                <label for="istifadeci-eli-ismayilov"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="istifadeci-eli-ismayilov" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Əli İsmayılov</span>
                                </label>

                                <label for="istifadeci-ramin-orucov-2"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="istifadeci-ramin-orucov-2" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Ramin Orucov Yaşar</span>
                                </label>
                            </div>
                        </div>
                        <div class="relative">
                            <span
                                class="text-[12px] text-tertiary-text dark:text-tertiary-text-color-dark font-medium">Vəzifə</span>
                            <button id="dropdownDefaultButton_position"
                                class="cursor-pointer font-normal font-poppins rounded-2xl text-[12px] px-5 py-2.5 text-center flex items-center justify-between border border-[#0000001A] w-full h-[34px] hover:bg-container-2 dark:bg-[#161E22] dark:text-white dark:border-[#FFFFFF1A] dark:hover:bg-[#1F282C]"
                                type="button" onclick="toggleDropdown_position()">
                                Seçim edin
                                <div>
                                    <img src="/images/Avankart/Sirket/chevron-down.svg" alt=""
                                        class="w-[15px] h-[13px] dark:invert" />
                                </div>
                            </button>
                            <div id="dropdown_position"
                                class="hidden absolute mt-2 w-[402px] max-h-[200px] overflow-y-auto overflow-x-hidden custom-scroll bg-white border-[.5px] border-stroke rounded-lg shadow z-50 dark:bg-[#161E22] dark:border-[#FFFFFF1A] visible">
                                <label for="subyekt-ux-designer"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="subyekt-ux-designer" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">UX Designer</span>
                                </label>

                                <label for="subyekt-project-manager"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="subyekt-project-manager" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Project Manager</span>
                                </label>

                                <label for="subyekt-cto"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="subyekt-cto" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">CTO</span>
                                </label>

                                <label for="subyekt-product-owner"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="subyekt-product-owner" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Product Owner</span>
                                </label>

                                <label for="subyekt-developer"
                                    class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                    <input type="checkbox" id="subyekt-developer" class="peer hidden" />
                                    <div
                                        class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <span class="dark:text-white">Developer</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65">Cinsi</span>
                        <div class="mt-[6px]">
                            <div class="flex items-center flex-wrap gap-4">
                                <label for="cbx-man"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-man" class="peer hidden" name="card_gender"
                                        value="man" />
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <div>Kişi</div>
                                </label>
                                <label for="cbx-woman"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-woman" class="peer hidden" name="card_gender"
                                        value="woman" />
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <div>Qadın</div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex items-center justify-end gap-3">
                    <button type="button"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages"
                        onclick="openFilterModal()">
                        Bağla
                    </button>
                    <button type="reset" onclick="clearFilters()"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages">
                        Filterləri təmizlə
                    </button>
                    <button onclick="applyFilters()" type="button"
                        class="bg-primary rounded-[50px] text-white text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:bg-hover-button">
                        Filterlə
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="fileUploadModal" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <form
        id="fileUploadForm"
        onsubmit="return false" 
        data-url="/muessiseler/muqavileler"
        class="px-6 w-[550px] mx-auto text-messages bg-body-bg rounded-2xl border-[3px] border-[#0000001A]">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <input type="hidden" name="muessise_id" id="muessiseId" value="<%= newMuessise.muessise_id%>"/>
            <div class="w-full flex items-center justify-between">
                <div class="mt-6 mb-4">
                    <h1 class="text-[17px] font-semibold">Fayl əlavə et</h1>
                    <span class="text-[13px] font-normal opacity-50">Sorğu ilə əlaqəli faylları buraya əlavə edin</span>
                </div>
                <div class="icon stratis-x-02 text-xs cursor-pointer" onclick="toggleFileUploadModal()"></div>
            </div>
            <div>
                <div id="uploadArea"
                    class="w-full h-[191px] hover:bg-[#88649A1A] border-2 border-dashed border-[#0000001A] dark:border-[#FFFFFF1A] rounded-[8px] flex items-center flex-col">
                    <div class="py-6">
                        <div>
                            <img src="/images/Sorgular Pages Images/upload.svg" alt="Upload" class="m-auto" />
                        </div>
                        <div class="py-3">
                            <span class="text-[13px] font-normal">Yükləmək üçün fayllarınızı sürüşdürüb, buraxın</span>
                            <div class="flex items-center justify-center gap-3">
                                <hr class="w-[73px] h-[1px] text-[#0000001A] dark:text-[#FFFFFF1A]" />
                                <div
                                    class="text-messages dark:text-primary-text-color-dark opacity-50 font-normal text-sm">
                                    Və ya
                                </div>
                                <hr class="w-[73px] h-[1px] text-[#0000001A] dark:text-[#FFFFFF1A]" />
                            </div>
                            <label
                                class="flex items-center gap-2 px-4 mt-2 py-2 bg-menu border border-surface-variant dark:border-surface-variant-dark rounded-full cursor-pointer">
                                <div class="flex items-center justify-center m-auto gap-2 hover:text-primary">
                                    <div class="icon stratis-upload-01 w-3 h-[9px] mt-[5px]"></div>
                                    <span class="text-[13px] font-medium">Fayl əlavə et</span>
                                </div>
                                <input type="file" id="fileInput" class="hidden" name="file" />
                            </label>
                        </div>
                    </div>
                </div>
                <div class="pt-2">
                    <span class="text-start text-[12px] opacity-50 font-normal">Yalnız PDF, JPG, PNG faylları
                        dəstəklənir</span>
                </div>
                <div id="file-list"
                    class="hidden flex flex-col gap-4 mt-4 pr-1 max-h-[200px] overflow-y-auto custom-scroll"></div>
            </div>
            <div>
                <div class="flex items-center justify-end pt-4 pb-6 gap-3">
                    <button
                        type="button"
                        class="cursor-pointer py-[6.5px] px-[18px] bg-surface dark:bg-surface-dark text-[13px] font-medium text-on-surface-variant dark:text-on-surface-variant-dark rounded-[50px]"
                        onclick="toggleFileUploadModal()">Ləğv et</button>
                    <button
                        type="submit"
                        
                        class="cursor-pointer py-[6.5px] px-[18px] text-[13px] text-body-bg dark:text-body-bg-dark font-medium bg-primary hover:bg-hover-button rounded-[50px]">Yüklə</button>
                </div>
            </div>
        </form>
    </div>

    <div id="contractsFilterPop" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <div
            class="w-[450px] font-poppins dark:bg-menu-dark text-messages dark:text-primary-text-color-dark border-[#0000001A] dark:border-[#FFFFFF1A] border-[3px] shadow-[0px_0px_30px_0px_rgba(0,0,0,0.05)] rounded-2xl bg-white z-101 fixed top-[50%] left-[50%] transform -translate-y-1/2 -translate-x-1/2 p-6">
            <form onsubmit="return false;" data-url="/hesablashmalar/datatable" id="contractsFilterForm">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                <div>
                    <div class="flex items-center justify-between">
                        <div class="text-[15px] font-medium">Filter</div>
                        <div onclick="closeContractsFilterModal()"
                            class="icon stratis-x-02 text-xs cursor-pointer dark:hidden"></div>
                    </div>
                </div>
                <div class="flex flex-col gap-2 pb-5">
                    <div>
                        <span class="text-[12px] font-medium opacity-65 dark:text-white">Tarix aralığı</span>
                        <div class="flex flex-col items-center gap-3">
                            <div class="w-full">
                                <div onclick="openContractsDatePicker('contractsStartDate')" class="relative group">
                                    <input id="contractsStartDate" type="date"
                                        class="contracts-date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                        placeholder="dd/mm/yyyy" name="contracts_start_date" />
                                    <div
                                        class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 mt-1.5">
                                    <div class="icon stratis-information-circle-contained w-3 h-3 opacity-50"></div>
                                    <div class="text-[11px] font-normal opacity-50">
                                        Başlanğıc tarixini qeyd edin
                                    </div>
                                </div>
                            </div>

                            <div class="w-full mt-2">
                                <div onclick="openContractsDatePicker('contractsEndDate')" class="relative group">
                                    <input id="contractsEndDate" type="date"
                                        class="contracts-date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                        placeholder="dd/mm/yyyy" name="contracts_end_date" />
                                    <div
                                        class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 mt-1.5">
                                    <div class="icon stratis-information-circle-contained w-3 h-3 opacity-50"></div>
                                    <div class="text-[11px] font-normal opacity-50">
                                        Son tarixi qeyd edin
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex items-center justify-end gap-3">
                    <button type="button"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages"
                        onclick="closeContractsFilterModal()">
                        Bağla
                    </button>
                    <button type="reset" onclick="clearContractsFilters()"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages">
                        Filterləri təmizlə
                    </button>
                    <button onclick="applyContractsFilters()" type="button"
                        class="bg-primary rounded-[50px] text-white text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:bg-hover-button">
                        Filterlə
                    </button>
                </div>
            </form>
        </div>
    </div>

    <%- include('./popupredakte', {poptitle: 'Redaktə et', type: 'edit', allCards: cards, muessise_id: newMuessise._id ?? '', editData: newMuessise }) %>

    <!-- Include Restaurant Details Modal for Diff Display -->
    <%- include('../../partials/muessise/restoranDetails', {muessise: newMuessise}) %>

    <div id="emeliyyatlarFilterPopup"
        class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-150">
        <div
            class="w-[450px] font-poppins dark:bg-menu-dark text-messages dark:text-primary-text-color-dark border-[#0000001A] dark:border-[#FFFFFF1A] border-[3px] shadow-[0px_0px_30px_0px_rgba(0,0,0,0.05)] rounded-2xl bg-white z-151 fixed top-[50%] left-[50%] transform -translate-y-1/2 -translate-x-1/2 p-6">
            <form onsubmit="return false;" data-url="/muessise/datatable" id="emeliyyatlarFilterForm">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                <div>
                    <div class="flex items-center justify-between">
                        <div class="text-[15px] font-medium">Filter</div>
                        <div onclick="openEmeliyyatlarFilterModal()"
                            class="icon stratis-x-02 text-xs cursor-pointer dark:hidden">
                        </div>
                    </div>
                </div>
                <div class="flex flex-col gap-2 pt-3 pb-5">
                    <div>
                        <span class="text-[12px] font-medium opacity-65 dark:text-white">Tarix aralığı</span>
                        <div class="flex items-center gap-3">

                            <!-- Başlanğıc tarix -->
                            <div class="w-1/2">
                                <div onclick="openDatePicker('emeliyyatlarStartDate')" class="relative w-[195px] group">
                                    <input id="emeliyyatlarStartDate" type="date"
                                        class="date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none
          hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
          active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                        placeholder="dd/mm/yyyy" name="emeliyyatlar_start_date">
                                    <div
                                        class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 mt-1.5">
                                    <div class="icon stratis-information-circle-contained w-3 h-3 opacity-50"></div>
                                    <div class="text-[11px] font-normal opacity-50">Başlanğıc tarixini qeyd edin</div>
                                </div>
                            </div>

                            <!-- Son tarix -->
                            <div class="w-1/2">
                                <div onclick="openDatePicker('emeliyyatlarEndDate')" class="relative w-[195px] group">
                                    <input id="emeliyyatlarEndDate" type="date"
                                        class="date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none
          hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
          active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                        placeholder="dd/mm/yyyy" name="emeliyyatlar_end_date">
                                    <div
                                        class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 mt-1.5">
                                    <div class="icon stratis-information-circle-contained w-3 h-3 opacity-50"></div>
                                    <div class="text-[11px] font-normal opacity-50">Son tarixi qeyd edin</div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65">Status</span>
                        <div class="mt-[6px]">
                            <div class="flex items-center flex-wrap gap-4">

                                <!-- Aktiv -->
                                <label for="emeliyyatlar-cbx-aktiv"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="emeliyyatlar-cbx-aktiv" class="peer hidden"
                                        name="emeliyyatlar_card_status" value="aktiv">
                                    <div class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
      peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <div>Aktiv</div>
                                </label>

                                <!-- Gözləyir -->
                                <label for="emeliyyatlar-cbx-gozleyir"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="emeliyyatlar-cbx-gozleyir" class="peer hidden"
                                        name="emeliyyatlar_card_status" value="gozleyir">
                                    <div class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
      peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <div>Gözləyir</div>
                                </label>

                                <!-- Tamamlandı -->
                                <label for="emeliyyatlar-cbx-tamamlandi"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="emeliyyatlar-cbx-tamamlandi" class="peer hidden"
                                        name="emeliyyatlar_card_status" value="tamamlandi">
                                    <div class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
      peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <div>Tamamlandı</div>
                                </label>

                                <!-- Report edildi -->
                                <label for="emeliyyatlar-cbx-report"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="emeliyyatlar-cbx-report" class="peer hidden"
                                        name="emeliyyatlar_card_status" value="report">
                                    <div class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
      peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                    </div>
                                    <div>Report edildi</div>
                                </label>

                            </div>

                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65">Məbləğ aralığı</span>
                        <div class="value-container mt-2">
                            <span id="min-mebleg-value"
                                class="value-label text-[13px] text-messages font-medium"></span>
                            <span id="max-mebleg-value"
                                class="value-label text-[13px] text-messages font-medium"></span>
                        </div>
                        <div id="mebleg-slider" class="mt-2"></div>
                        <div class="flex items-center justify-between text-[11px] opacity-50 font-medium mt-2">
                            <span>Min</span>
                            <span>Max</span>
                        </div>
                    </div>
                </div>
                <!-- Buttons -->
                <div class="flex items-center justify-end gap-3">
                    <button type="button"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages"
                        onclick="openEmeliyyatlarFilterModal()">
                        Bağla
                    </button>
                    <button onclick="clearEmeliyyatlarFilters()"
                    type="button"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages">
                        Filterləri təmizlə
                    </button>
                    <button onclick="applyEmeliyyatlarFilters()" type="submit"
                        class="bg-primary rounded-[50px] text-white text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:bg-hover-button">
                        Filterlə
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="companiesFilterPopup" class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <div
            class="w-[450px] font-poppins dark:bg-menu-dark text-messages dark:text-primary-text-color-dark border-[#0000001A] dark:border-[#FFFFFF1A] border-[3px] shadow-[0px_0px_30px_0px_rgba(0,0,0,0.05)] rounded-2xl bg-white z-101 fixed top-[50%] left-[50%] transform -translate-y-1/2 -translate-x-1/2 p-6">
            <form onsubmit="return false;" data-url="/hesablashmalar/datatable" id="companiesFilterForm">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                <div>
                    <div class="flex items-center justify-between">
                        <div class="text-[15px] font-medium">Companies Filter</div>
                        <div onclick="closeCompaniesFilterModal()"
                            class="icon stratis-x-02 text-xs cursor-pointer dark:hidden">
                        </div>
                    </div>
                </div>
                <div class="flex flex-col gap-2 pt-3 pb-5">
                    <div class="relative">
                        <span
                            class="text-[12px] text-tertiary-text dark:text-tertiary-text-color-dark font-medium">Şirkət</span>
                        <button id="dropdownDefaultButton_companies"
                            class="cursor-pointer font-normal font-poppins rounded-2xl text-[12px] px-5 py-2.5 text-center flex items-center justify-between border border-[#0000001A] w-full h-[34px] mt-1 hover:bg-container-2 dark:bg-[#161E22] dark:text-white dark:border-[#FFFFFF1A] dark:hover:bg-[#1F282C]"
                            type="button" onclick="toggleDropdown_companies()">
                            Seçim edin
                            <div>
                                <img src="/images/Avankart/Sirket/chevron-down.svg" alt=""
                                    class="w-[15px] h-[13px] dark:invert" />
                            </div>
                        </button>
                        <div id="dropdown_companies"
                            class="hidden absolute mt-2 w-[402px] max-h-[200px] overflow-y-auto overflow-x-hidden custom-scroll bg-white border-[.5px] border-stroke rounded-lg shadow z-50 dark:bg-[#161E22] dark:border-[#FFFFFF1A] visible">
                            <label for="company-abc"
                                class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:hover:bg-input-hover-dark">
                                <input type="checkbox" id="company-abc" class="peer hidden" />
                                <div
                                    class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                    <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                </div>
                                <span class="dark:text-white">ABC Company</span>
                            </label>

                            <label for="company-xyz"
                                class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                <input type="checkbox" id="company-xyz" class="peer hidden" />
                                <div
                                    class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                    <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                </div>
                                <span class="dark:text-white">XYZ Ltd.</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65">Məbləğ aralığı</span>
                        <div class="value-container mt-2">
                            <span id="min-company-amount-value"
                                class="value-label text-[13px] text-messages font-medium"></span>
                            <span id="max-company-amount-value"
                                class="value-label text-[13px] text-messages font-medium"></span>
                        </div>
                        <div id="company-amount-slider" class="mt-2"></div>
                        <div class="flex items-center justify-between text-[11px] opacity-50 font-medium mt-2">
                            <span>Min</span>
                            <span>Max</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center justify-end gap-3">
                    <button type="button"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages"
                        onclick="closeCompaniesFilterModal()">
                        Bağla
                    </button>
                    <button type="reset" onclick="clearCompaniesFilters()"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages">
                        Filterləri təmizlə
                    </button>
                    <button onclick="applyCompaniesFilters()" type="button"
                        class="bg-primary rounded-[50px] text-white text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:bg-hover-button">
                        Filterlə
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="transactionsFilterPopup"
        class="hidden fixed inset-0 bg-[#0000002A] flex items-center justify-center z-100">
        <div
            class="w-[450px] font-poppins dark:bg-menu-dark text-messages dark:text-primary-text-color-dark border-[#0000001A] dark:border-[#FFFFFF1A] border-[3px] shadow-[0px_0px_30px_0px_rgba(0,0,0,0.05)] rounded-2xl bg-white z-101 fixed top-[50%] left-[50%] transform -translate-y-1/2 -translate-x-1/2 p-6">
            <form onsubmit="return false;" data-url="/hesablashmalar/datatable" id="transactionsFilterForm">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                <div>
                    <div class="flex items-center justify-between">
                        <div class="text-[15px] font-medium">Transactions Filter</div>
                        <div onclick="closeTransactionsFilterModal()"
                            class="icon stratis-x-02 text-xs cursor-pointer dark:hidden">
                        </div>
                    </div>
                </div>
                <div class="flex flex-col gap-2 pt-3 pb-5">
                    <div class="relative">
                        <span
                            class="text-[12px] text-tertiary-text dark:text-tertiary-text-color-dark font-medium">İstifadəçi</span>
                        <button id="dropdownDefaultButton_transactionUsers"
                            class="cursor-pointer font-normal font-poppins rounded-2xl text-[12px] px-5 py-2.5 text-center flex items-center justify-between border border-[#0000001A] w-full h-[34px] mt-1 hover:bg-container-2 dark:bg-[#161E22] dark:text-white dark:border-[#FFFFFF1A] dark:hover:bg-[#1F282C]"
                            type="button" onclick="toggleDropdown_transactionUsers()">
                            Seçim edin
                            <div>
                                <img src="/images/Avankart/Sirket/chevron-down.svg" alt=""
                                    class="w-[15px] h-[13px] dark:invert" />
                            </div>
                        </button>
                        <div id="dropdown_transactionUsers"
                            class="hidden absolute mt-2 w-[402px] max-h-[200px] overflow-y-auto overflow-x-hidden custom-scroll bg-white border-[.5px] border-stroke rounded-lg shadow z-50 dark:bg-[#161E22] dark:border-[#FFFFFF1A] visible">
                            <label for="user-abc"
                                class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:hover:bg-input-hover-dark">
                                <input type="checkbox" id="user-abc" class="peer hidden" />
                                <div
                                    class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                    <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                </div>
                                <span class="dark:text-white">User ABC</span>
                            </label>

                            <label for="user-xyz"
                                class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                <input type="checkbox" id="user-xyz" class="peer hidden" />
                                <div
                                    class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                    <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                </div>
                                <span class="dark:text-white">User XYZ</span>
                            </label>
                        </div>
                    </div>
                    <div class="relative">
                        <span
                            class="text-[12px] text-tertiary-text dark:text-tertiary-text-color-dark font-medium">Məkan</span>
                        <button id="dropdownDefaultButton_transactionLocations"
                            class="cursor-pointer font-normal font-poppins rounded-2xl text-[12px] px-5 py-2.5 text-center flex items-center justify-between border border-[#0000001A] w-full h-[34px] mt-1 hover:bg-container-2 dark:bg-[#161E22] dark:text-white dark:border-[#FFFFFF1A] dark:hover:bg-[#1F282C]"
                            type="button" onclick="toggleDropdown_transactionLocations()">
                            Seçim edin
                            <div>
                                <img src="/images/Avankart/Sirket/chevron-down.svg" alt=""
                                    class="w-[15px] h-[13px] dark:invert" />
                            </div>
                        </button>
                        <div id="dropdown_transactionLocations"
                            class="hidden absolute mt-2 w-[402px] max-h-[200px] overflow-y-auto overflow-x-hidden custom-scroll bg-white border-[.5px] border-stroke rounded-lg shadow z-50 dark:bg-[#161E22] dark:border-[#FFFFFF1A] visible">
                            <label for="location-abc"
                                class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:hover:bg-input-hover-dark">
                                <input type="checkbox" id="location-abc" class="peer hidden" />
                                <div
                                    class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                    <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                </div>
                                <span class="dark:text-white">Location ABC</span>
                            </label>

                            <label for="location-xyz"
                                class="flex items-center px-4 py-1 text-[13px] hover:bg-input-hover cursor-pointer select-none gap-2 dark:bg-[#161E22] dark:hover:bg-input-hover-dark">
                                <input type="checkbox" id="location-xyz" class="peer hidden" />
                                <div
                                    class="w-[14px] h-[14px] border border-surface-variant dark:border-surface-variant-dark rounded-[2px] flex items-center justify-center dark:bg-[#161E22] text-on-primary dark:text-side-bar-item-dark peer-checked:bg-primary dark:peer-checked:bg-primary-dark peer-checked:text-on-primary dark:peer-checked:text-on-primary-dark peer-checked:border-primary dark:peer-checked:border-primary-dark transition cursor-pointer">
                                    <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center"></div>
                                </div>
                                <span class="dark:text-white">Location XYZ</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65 dark:text-white">Tarix aralığı</span>
                        <div class="flex items-center gap-3">

                            <!-- Başlanğıc tarix -->
                            <div class="w-1/2">
                                <div onclick="openDatePicker('transactionsStartDate')" class="relative w-[195px] group">
                                    <input id="transactionsStartDate" type="date"
                                        class="date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none
hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer" placeholder="dd/mm/yyyy"
                                        name="transactions_start_date">
                                    <div
                                        class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 mt-1.5">
                                    <div class="icon stratis-information-circle-contained w-3 h-3 opacity-50"></div>
                                    <div class="text-[11px] font-normal opacity-50">Başlanğıc tarixini qeyd edin</div>
                                </div>
                            </div>

                            <!-- Son tarix -->
                            <div class="w-1/2">
                                <div onclick="openDatePicker('transactionsEndDate')" class="relative w-[195px] group">
                                    <input id="transactionsEndDate" type="date"
                                        class="date-input py-[6.5px] text-[12px] font-medium text-messages placeholder-outline border border-stroke rounded-full px-3 w-full appearance-none
hover:bg-input-hover focus:border-focus focus:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] focus:ring-0 focus:outline-none
active:border-focus active:shadow-[0px_0px_0px_2.5px_var(--color-button-disabled)] transition-all ease-out duration-300 cursor-pointer"
                                        placeholder="dd/mm/yyyy" name="transactions_end_date">
                                    <div
                                        class="icon stratis-calendar-02 absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-messages group-focus-within:text-focus cursor-pointer">
                                    </div>
                                </div>
                                <div class="flex items-center gap-2 mt-1.5">
                                    <div class="icon stratis-information-circle-contained w-3 h-3 opacity-50"></div>
                                    <div class="text-[11px] font-normal opacity-50">Son tarixi qeyd edin</div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65">Kart kateqoriyası</span>
                        <div class="mt-[6px]">
                            <div class="flex items-center flex-wrap gap-4">
                                <label for="cbx-yemək"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-yemək" class="peer hidden" name="card_category"
                                        value="yemək">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Yemək kartı</div>
                                </label>
                                <label for="cbx-yanacaq"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-yanacaq" class="peer hidden" name="card_category"
                                        value="yanacaq">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Yanacaq kartı</div>
                                </label>
                                <label for="cbx-hediyye"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-hediyye" class="peer hidden" name="card_category"
                                        value="hədiyyə">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Hədiyyə kartı</div>
                                </label>
                                <label for="cbx-market"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-market" class="peer hidden" name="card_category"
                                        value="market">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Market kartı</div>
                                </label>
                                <label for="cbx-biznes"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-biznes" class="peer hidden" name="card_category"
                                        value="biznes">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Biznes kartı</div>
                                </label>
                                <label for="cbx-premium"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-premium" class="peer hidden" name="card_category"
                                        value="premium">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Premium kartı</div>
                                </label>
                                <label for="cbx-avto-yuma"
                                    class="flex items-center gap-2 cursor-pointer select-none text-[13px] font-normal">
                                    <input type="checkbox" id="cbx-avto-yuma" class="peer hidden" name="card_category"
                                        value="avto_yuma">
                                    <div
                                        class="bg-menu border border-surface-variant rounded-[2px] w-[18px] h-[18px] flex items-center justify-center text-on-primary 
                           peer-checked:bg-primary peer-checked:text-on-primary peer-checked:border-primary transition">
                                        <div class="icon stratis-check-01 scale-60 h-[18px] w-[18px] text-center">
                                        </div>
                                    </div>
                                    <div>Avto Yuma kartı</div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div>
                        <span class="text-[12px] font-medium opacity-65">Məbləğ aralığı</span>
                        <div class="value-container mt-2">
                            <span id="min-transaction-amount-value"
                                class="value-label text-[13px] text-messages font-medium"></span>
                            <span id="max-transaction-amount-value"
                                class="value-label text-[13px] text-messages font-medium"></span>
                        </div>
                        <div id="transaction-amount-slider" class="mt-2"></div>
                        <div class="flex items-center justify-between text-[11px] opacity-50 font-medium mt-2">
                            <span>Min</span>
                            <span>Max</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center justify-end gap-3">
                    <button type="button"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages"
                        onclick="closeTransactionsFilterModal()">
                        Bağla
                    </button>
                    <button type="reset" onclick="clearTransactionsFilters()"
                        class="bg-surface rounded-[50px] dark:bg-surface-bright-dark dark:text-on-surface-variant-dark text-on-surface-variant text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:text-messages">
                        Filterləri təmizlə
                    </button>
                    <button onclick="applyTransactionsFilters()" type="button"
                        class="bg-primary rounded-[50px] text-white text-[13px] font-medium px-[18px] py-[6.5px] cursor-pointer hover:bg-hover-button">
                        Filterlə
                    </button>
                </div>
            </form>
        </div>
    </div>
    

    <% scripts = `<script src="/js/jquery-ui.js"></script>
    <script src="/js/datatables/datatables.min.js"></script>
    <script src="/js/Avankart/muessiseler/muessiseler.js"></script>
    <script src="/js/Avankart/muessiseler/dashboard.js"></script>
    <script src="/js/Avankart/muessiseler/sorgular.js"></script>
    <script src="/js/Avankart/muessiseler/userTable.js"></script>
    <script src="/js/Avankart/muessiseler/selahiyyetTable.js"></script>
    <script src="/js/Avankart/muessiseler/selahiyyetDetailTable.js"></script>
    <script src="/js/Avankart/muessiseler/jobTable.js"></script>
    <script src="/js/Avankart/muessiseler/jobDetailTable.js"></script>
    <script src="/js/Avankart/muessiseler/contractsTable.js"></script>
    <script src="/js/Avankart/muessiseler/contractsTableGrid2.js"></script>
    <script src="/js/Avankart/muessiseler/companiesTable.js"></script>
    <script src="/js/Avankart/muessiseler/myTableMuessise.js"></script>
    <script src="/js/Avankart/muessiseler/emeliyyatlar.js"></script>
    <script src="/js/Avankart/muessiseler/emeliyyatlarTable.js"></script>
    <script src="/js/Avankart/muessiseler/transactionsTable.js"></script>
    <script src="/js/Avankart/muessiseler/edit.js"></script>
    <script src="/js/Avankart/muessiseler/notifications.js"></script>
    <script src="/js/Avankart/muessiseler/countdown.js"></script>
    <script src="/js/Avankart/muessiseler/openDatePicker.js"></script>`; %>
    <link
  rel="stylesheet"
  href="https://unpkg.com/leaflet/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  const mapModal = document.getElementById("mapModal");
  let map, marker, selectedCoords;

  // Modal açmaq
  function openMapModal(addressId = null, hiddenId = null) {
    window.forAddress = addressId;
    window.forHidden = hiddenId;
    mapModal.classList.remove("hidden");

    // Xəritə ilk dəfə açılırsa init et
    if (!map) {
      initMap();
    }
    setTimeout(() => {
      map.invalidateSize();
    }, 200);
  }

  // Modal bağlamaq
  function closeMapModal() {
    mapModal.classList.add("hidden");
  }

  // Xəritəni yarat
  function initMap() {
    map = L.map("map").setView([40.4093, 49.8671], 12); // Bakı koordinatları
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "© OpenStreetMap",
    }).addTo(map);

    map.on("click", function (e) {
      selectedCoords = e.latlng;
      if (marker) {
        marker.setLatLng(e.latlng);
      } else {
        marker = L.marker(e.latlng).addTo(map);
      }
    });
  }

  // Seçilən koordinatları inputlara yaz
  function selectCoords() {
    if (!selectedCoords) return;

    if (window.forHidden) {
      document.getElementById(window.forHidden).value =
        selectedCoords.lat + "," + selectedCoords.lng;
    }
    if (window.forAddress) {
      document.getElementById(window.forAddress).value =
        "Koordinatlar: " +
        selectedCoords.lat.toFixed(5) +
        ", " +
        selectedCoords.lng.toFixed(5);
    }

    closeMapModal();
  }
</script>

<script>
  // =====================================================
  // MUESSISE DIFF MODAL SYSTEM - STEP BY STEP
  // =====================================================
  
  console.log('🚀 Loading diff modal system...');
  
  // Make all cards available globally for smart merge operations
  window.allCards = <%- JSON.stringify(cards || []) %>;
  console.log('🎴 Global allCards loaded:', window.allCards.length, 'cards');
  
  // Function to save muessise changes to sessionStorage (not API)
  function saveMuessiseChangesTemporarily() {
    console.log('💾 Saving muessise changes to sessionStorage...');
    
    // Get the form data from the edit modal
    const form = document.getElementById('saveMuessiseForm');
    if (!form) {
      console.error('❌ Edit form not found');
      alert('Redaktə formu tapılmadı');
      return;
    }

    // Get form data
    const formData = new FormData(form);
    const changes = {};
    
    // Convert FormData to object, excluding CSRF and ID fields
    // Also handle array fields properly (remove [] from keys and collect multiple values)
    for (let [key, value] of formData.entries()) {
      if (key !== '_csrf' && key !== 'muessise_id') {
        // Clean up array notation from key names
        let cleanKey = key;
        let isArrayField = false;
        
        if (key.endsWith('[]')) {
          cleanKey = key.slice(0, -2); // Remove '[]' from the end
          isArrayField = true;
        }
        
        // Handle array fields
        if (isArrayField) {
          if (!changes[cleanKey]) {
            changes[cleanKey] = [];
          }
          // Add value to array (avoiding duplicates)
          if (!changes[cleanKey].includes(value)) {
            changes[cleanKey].push(value);
          }
        } else {
          // Regular field
          changes[cleanKey] = value;
        }
      }
    }
    
    // Get all values for array fields using FormData.getAll()
    for (let [key] of formData.entries()) {
      if (key.endsWith('[]') && key !== '_csrf' && key !== 'muessise_id') {
        const cleanKey = key.slice(0, -2);
        const allValues = formData.getAll(key);
        changes[cleanKey] = allValues;
      }
    }
    
    console.log('📝 Captured changes (cleaned):', changes);
    
    // Get current muessise ID for tracking
    const currentMuessiseId = '<%= newMuessise._id || newMuessise.muessise_id %>';
    
    // Check if we have stored data for a different muessise and clear if so
    const existingOriginalData = sessionStorage.getItem('muessise_original_data');
    if (existingOriginalData) {
      try {
        const parsedExistingData = JSON.parse(existingOriginalData);
        if (parsedExistingData.muessise_id !== currentMuessiseId) {
          console.log('🔄 Different muessise detected, clearing old sessionStorage data');
          console.log('   - Old muessise ID:', parsedExistingData.muessise_id);
          console.log('   - New muessise ID:', currentMuessiseId);
          sessionStorage.removeItem('muessise_temp_changes');
          sessionStorage.removeItem('muessise_original_data');
        } else {
          console.log('✅ Same muessise detected, keeping existing original data');
        }
      } catch (e) {
        console.log('⚠️ Error parsing existing original data, clearing sessionStorage');
        sessionStorage.removeItem('muessise_temp_changes');
        sessionStorage.removeItem('muessise_original_data');
      }
    }
    
    // Store original data for the current muessise (only if not already stored for this muessise)
    if (!sessionStorage.getItem('muessise_original_data')) {
      const originalData = <%- JSON.stringify({
        muessise_id: newMuessise._id || newMuessise.muessise_id,
        muessise_name: newMuessise.muessise_name || "",
        sirket_name: newMuessise.sirket_name || "",
        description: newMuessise.description || "",
        address: newMuessise.address || "",
        activity_type: newMuessise.activity_type || "",
        muessise_category: newMuessise.muessise_category || "",
        commission_percentage: newMuessise.commission_percentage || "",
        profile_image_path: newMuessise.profile_image_path || newMuessise.profileImg || "",
        xarici_cover_image_path: newMuessise.xarici_cover_image_path || "",
        contact_email: newMuessise.contact_email || "",
        contact_phone: newMuessise.contact_phone || "",
        contact_website: newMuessise.contact_website || "",
        phonePrefix: newMuessise.phonePrefix || "",
        authorized_person_name: newMuessise.authorized_person_name || "",
        authorized_person_email: newMuessise.authorized_person_email || "",
        authorized_person_phone: newMuessise.authorized_person_phone || "",
        authorized_person_phone_prefix: newMuessise.authorized_person_phone_prefix || "",
        company_name: newMuessise.company_name || "",
        voen: newMuessise.voen || "",
        bank_name: newMuessise.bank_name || "",
        iban: newMuessise.iban || "",
        swift_code: newMuessise.swift_code || "",
        correspondent_account: newMuessise.correspondent_account || "",
        huquqiaddress: newMuessise.huquqiaddress || "",
        coordinates: newMuessise.coordinates || "",
        huquqicoordinates: newMuessise.huquqicoordinates || "",
        gender: newMuessise.gender || "",
        social_media: newMuessise.social || "",
        cards: newMuessise.cards || [],
        services: newMuessise.services || [],
        phone: newMuessise.phone || [],
        email: newMuessise.email || [],
        website: newMuessise.website || [],
        schedule: newMuessise.schedule || {},
        profile_image: newMuessise.profile_image || {},
        xarici_cover_image: newMuessise.xarici_cover_image || {},
        daxili_cover_image: newMuessise.daxili_cover_image || {}
      }) %>;
      
      sessionStorage.setItem('muessise_original_data', JSON.stringify(originalData));
      console.log('💾 Stored original data for muessise:', currentMuessiseId);
    } else {
      console.log('📋 Original data already exists for this muessise, not overwriting');
    }
    
    // Store the changes
    sessionStorage.setItem('muessise_temp_changes', JSON.stringify(changes));
    
    // Close the edit modal
    if (typeof closeMainEditPopup === 'function') {
      closeMainEditPopup();
    }
    
    // Show success message
    alert('Dəyişikliklər müvəqqəti olaraq saxlanıldı. "Dəyişikliyi təsdiqlə" düyməsini basaraq tətbiq edin.');
    
    console.log('✅ Changes saved to sessionStorage successfully');
  }
  
  // Enhanced function to show the diff modal with side-by-side comparison
  function showChangesDiffModal() {
    console.log('🎯 showChangesDiffModal called!');
    
    // Get current muessise ID
    const currentMuessiseId = '<%= newMuessise._id || newMuessise.muessise_id %>';
    
    // Check if there are any temporary changes
    const tempChanges = JSON.parse(sessionStorage.getItem('muessise_temp_changes') || '{}');
    const originalData = JSON.parse(sessionStorage.getItem('muessise_original_data') || '{}');
    
    console.log('📊 Retrieved from sessionStorage:');
    console.log('   - Current muessise ID:', currentMuessiseId);
    console.log('   - Temp changes:', tempChanges);
    console.log('   - Original data:', originalData);
    
    // Validate that original data is for the current muessise
    if (originalData.muessise_id && originalData.muessise_id !== currentMuessiseId) {
      console.log('⚠️ Original data is for different muessise, clearing sessionStorage');
      sessionStorage.removeItem('muessise_temp_changes');
      sessionStorage.removeItem('muessise_original_data');
      alert('Məlumatlar fərqli müəssisəyə aiddir. Zəhmət olmasa əvvəlcə redaktə edin və yadda saxlayın.');
      return;
    }
    
    if (Object.keys(tempChanges).length === 0) {
      alert('Heç bir müvəqqəti dəyişiklik tapılmadı. Əvvəlcə müəssisəni redaktə edin və "Yadda saxla" düyməsini basın.');
      return;
    }
    
    // Open the modal first
    const modal = document.getElementById('restaurantDetailPopup');
    if (modal) {
      modal.classList.remove('hidden');
    //   modal.style.display = 'flex';
      console.log('✅ Restaurant detail modal opened successfully');
      
      // Then populate with comparison data
      populateComparisonModal(originalData, tempChanges);
    } else {
      console.error('❌ Modal element with ID "restaurantDetailPopup" not found');
    }
  }

  function abortMuessiseChanges() {
    console.log('🛑 Aborting muessise changes and clearing sessionStorage...');
    sessionStorage.removeItem('muessise_temp_changes');
    sessionStorage.removeItem('muessise_original_data');
    alertModal('Müvəqqəti dəyişikliklər ləğv edildi.');
    // Optionally, you can also close the modal if it's open
    const modal = document.getElementById('restaurantDetailPopup');
    if (modal) {
      modal.classList.add('hidden');
    }
    console.log('✅ SessionStorage cleared successfully');
  }
  
  // Function to normalize data formats (schedule and social media)
  function normalizeData(data) {
    const normalizedData = { ...data };
    
    // Normalize schedule data
    const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
    const hasFlatSchedule = days.some(day => data[`${day}_enabled`] !== undefined);
    
    if (hasFlatSchedule) {
      normalizedData.schedule = {};
      days.forEach(day => {
        const enabled = data[`${day}_enabled`] === 'on' || data[`${day}_enabled`] === true;
        const start = data[`${day}_start`] || '';
        const end = data[`${day}_end`] || '';
        
        if (enabled || start || end) {
          normalizedData.schedule[day] = {
            enabled: enabled,
            start: start,
            end: end
          };
        }
        
        // Remove flat properties
        delete normalizedData[`${day}_enabled`];
        delete normalizedData[`${day}_start`];
        delete normalizedData[`${day}_end`];
      });
    }
    
    // Normalize social media data
    if (data.social_media) {
      console.log('🔄 Processing social_media:', data.social_media, typeof data.social_media);
      try {
        // If social_media is already an array, use it directly
        if (Array.isArray(data.social_media)) {
          console.log('📱 Social_media already in array format:', data.social_media);
          normalizedData.social = data.social_media;
        }
        // If social_media is a string (JSON), parse it and convert to array format
        else if (typeof data.social_media === 'string') {
          const parsedSocial = JSON.parse(data.social_media);
          console.log('📱 Parsed social from string:', parsedSocial);
          normalizedData.social = Object.entries(parsedSocial);
        }
        // If it's an object, convert to array format
        else if (typeof data.social_media === 'object' && !Array.isArray(data.social_media)) {
          console.log('📱 Converting social from object:', data.social_media);
          normalizedData.social = Object.entries(data.social_media);
        }
        // Remove the original social_media property
        delete normalizedData.social_media;
        console.log('📱 Normalized social result:', normalizedData.social);
      } catch (e) {
        console.warn('Failed to parse social_media:', e);
      }
    }
    
    // If social is already in correct array format, keep it
    if (data.social && Array.isArray(data.social)) {
      console.log('📱 Social already in array format:', data.social);
      normalizedData.social = data.social;
    }
    // Handle social as Map (common in Mongoose)
    else if (data.social && typeof data.social === 'object' && data.social.constructor.name === 'Map') {
      console.log('📱 Social is a Map, converting:', data.social);
      normalizedData.social = Array.from(data.social.entries());
    }
    // Handle social as plain object
    else if (data.social && typeof data.social === 'object' && !Array.isArray(data.social)) {
      console.log('📱 Social is an object, converting:', data.social);
      normalizedData.social = Object.entries(data.social);
    }
    
    return normalizedData;
  }
  
  // Function to intelligently merge original and changed data
  function smartMergeData(originalData, changedData) {
    console.log('🔄 Smart merging data...');
    console.log('📊 Original for merge:', originalData);
    console.log('📊 Changed for merge:', changedData);
    
    // Start with original data
    const mergedData = { ...originalData };
    
    // Merge each field from changed data
    Object.keys(changedData).forEach(key => {
      if (key === 'cards' && changedData.cards && Array.isArray(changedData.cards)) {
        // Special handling for cards
        console.log('🎴 Smart merging cards...');
        console.log('🎴 Original cards:', originalData.cards);
        console.log('🎴 Changed cards:', changedData.cards);
        
        // If changed cards are just ID strings, convert them to full objects using original data
        if (changedData.cards.every(card => typeof card === 'string')) {
          console.log('🎴 Changed cards are ID strings, finding full objects...');
          console.log('🎴 MERGE DEBUG - Card IDs to find:', changedData.cards);
          console.log('🎴 MERGE DEBUG - Looking in original cards:', originalData.cards);
          
          const fullCardObjects = [];
          changedData.cards.forEach(cardId => {
            // First, try to find the full card object from original data
            let fullCard = null;
            if (originalData.cards && Array.isArray(originalData.cards)) {
              fullCard = originalData.cards.find(origCard => 
                origCard._id && origCard._id.toString() === cardId.toString()
              );
            }
            
            // If not found in original data, look in global allCards
            if (!fullCard && window.allCards && Array.isArray(window.allCards)) {
              fullCard = window.allCards.find(card => 
                card._id && card._id.toString() === cardId.toString()
              );
              if (fullCard) {
                console.log('✅ Found NEW card object in allCards for ID:', cardId, fullCard);
              }
            }
            
            if (fullCard) {
              fullCardObjects.push(fullCard);
              console.log('✅ Found full card object for ID:', cardId, fullCard);
            } else {
              console.warn('⚠️ Could not find full card object for ID:', cardId);
              console.warn('⚠️ Searched in original cards:', originalData.cards?.length || 0, 'cards');
              console.warn('⚠️ Searched in global allCards:', window.allCards?.length || 0, 'cards');
            }
          });
          
          mergedData.cards = fullCardObjects;
          console.log('🎴 MERGE RESULT - Final merged cards:', mergedData.cards);
          console.log('🎴 MERGE RESULT - Should contain only', changedData.cards.length, 'cards');
        } else {
          // Changed cards are already full objects, use them directly
          console.log('🎴 Changed cards are full objects, using directly');
          mergedData.cards = changedData.cards;
        }
      } else {
        // For non-card fields, use regular merge
        mergedData[key] = changedData[key];
      }
    });
    
    console.log('✅ Smart merge completed:', mergedData);
    return mergedData;
  }
  
  // Function to populate the modal with before/after comparison
  function populateComparisonModal(originalData, changedData) {
    console.log('🔄 Populating comparison modal with before/after data...');
    console.log('📊 Original data:', originalData);
    console.log('📊 Changed data:', changedData);
    
    // Normalize data formats (schedule and social media)
    const normalizedOriginal = normalizeData(originalData);
    const normalizedChanged = normalizeData(changedData);
    
    console.log('📊 Normalized original:', normalizedOriginal);
    console.log('📊 Normalized changed:', normalizedChanged);
    
    // Debug social media data
    console.log('🐛 DEBUG - Original social data:', normalizedOriginal.social);
    console.log('🐛 DEBUG - Changed social data:', normalizedChanged.social);
    
    // Update modal title to indicate it's a comparison
    const modalTitle = document.querySelector('#restaurantDetailPopup .text-\\[15px\\]');
    if (modalTitle) {
    //   modalTitle.innerHTML = '<span class="text-orange-600">⚠️</span> Dəyişikliklərin təsdiqi - ' + (originalData.muessise_name || changedData.muessise_name || 'Müəssisə');
    }
    
    // Add comparison headers
    addComparisonHeaders();
    
    // Populate left side with original data
    populateLeftSide(normalizedOriginal);
    
    // Populate right side with changed data (merging original + changes)
    const mergedData = smartMergeData(normalizedOriginal, normalizedChanged);
    populateRightSide(mergedData, normalizedChanged);
    
    // Add a summary banner
    const changedFieldsCount = Object.keys(changedData).length;
    addComparisonSummary(changedFieldsCount);
    
    console.log(`✅ Comparison modal populated with ${changedFieldsCount} changed fields`);
  }
  
  // Function to add comparison headers
  function addComparisonHeaders() {
    // Remove existing headers
    document.querySelectorAll('.comparison-header').forEach(el => el.remove());
    
    const leftColumn = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:first-child');
    const rightColumn = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:last-child');
    
    // if (leftColumn) {
    //   const leftHeader = document.createElement('div');
    //   leftHeader.className = 'comparison-header bg-red-50 dark:bg-red-900 p-3 text-center font-medium text-sm border-b border-red-200 dark:border-red-700';
    //   leftHeader.innerHTML = '<span class="text-red-600 dark:text-red-400">❌ Köhnə məlumatlar</span>';
    //   leftColumn.insertBefore(leftHeader, leftColumn.firstChild);
    // }
    
    // if (rightColumn) {
    //   const rightHeader = document.createElement('div');
    //   rightHeader.className = 'comparison-header bg-green-50 dark:bg-green-900 p-3 text-center font-medium text-sm border-b border-green-200 dark:border-green-700';
    //   rightHeader.innerHTML = '<span class="text-green-600 dark:text-green-400">✅ Yeni məlumatlar</span>';
    //   rightColumn.insertBefore(rightHeader, rightColumn.firstChild);
    // }
  }
  
  // Function to populate left side with original data
  function populateLeftSide(originalData) {
    console.log('◀️ Populating left side with original data', originalData);
    
    // The left side is already populated by the EJS template with muessise data
    // We just need to ensure it shows the original state
    
    // Update company name if it exists in original data
    if (originalData.muessise_name) {
      const leftCompanyName = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:first-child .text-\\[22px\\]');
      if (leftCompanyName) {
        leftCompanyName.textContent = originalData.muessise_name;
      }
    }
    
    // Update description 
    if (originalData.description) {
      const leftDescriptions = document.querySelectorAll('#restaurantDetailPopup .w-\\[50\\%\\]:first-child p.pt-2');
      leftDescriptions.forEach(desc => {
        if (desc.textContent.trim()) {
          desc.textContent = originalData.description;
        }
      });
    }
    
    // Update address
    if (originalData.address) {
      const leftAddress = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:first-child .iconex-location-1');
      if (leftAddress) {
        const addressSpan = leftAddress.parentElement.querySelector('span.opacity-65');
        if (addressSpan) {
          addressSpan.textContent = originalData.address;
        }
      }
    }

    if(originalData.cards && Array.isArray(originalData.cards)) {
        const leftCardsContainer = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:first-child .muessise-cards');
        console.log('🎴 LEFT SIDE - Container found:', !!leftCardsContainer);
        console.log('🎴 LEFT SIDE - Container selector:', '#restaurantDetailPopup .w-\\[50\\%\\]:first-child .muessise-cards');
        
        if (leftCardsContainer) {
            // Clear existing cards
            leftCardsContainer.innerHTML = '';
            console.log('🎴 LEFT SIDE - Container cleared');
            
            console.log('🎴 LEFT SIDE DEBUG:');
            console.log('🎴 originalData.cards (what should be ALL original cards):', originalData.cards);
            console.log('🎴 originalData.cards.length:', originalData.cards.length);
            console.log('🎴 Expected: Should show ALL original cards (4 cards in your case)');
            
            // Add each card with proper styling like in the detail page
            originalData.cards.forEach((card, index) => {
              console.log(`🎴 Left side - processing card ${index}:`, card, 'Type:', typeof card);
              
              // Handle different card data formats
              let cardData = card;
              
              // If card is just an ID string, we need to find the full card data
              if (typeof card === 'string') {
                console.log('🎴 Left side - card is ID string, need to find full card data:', card);
                // We can't resolve this without the full cards list, skip for now
                return;
              }
              
              // If card is an object but missing properties, log it
              if (typeof card === 'object') {
                console.log('🎴 Left side - card object properties:', Object.keys(card));
                console.log('🎴 Left side - card icon:', card.icon, 'Card name:', card.name);
              }
              
              const cardDiv = document.createElement('div');
              cardDiv.className = 'w-[84px] h-[27px] flex gap-1 items-center justify-center rounded-full';
              cardDiv.style.backgroundColor = cardData.background_color || '#ffffff';
              
              // Create icon element
              const iconImg = document.createElement('img');
              iconImg.className = 'w-[16px] h-[16px]';
              iconImg.src = `/images/muessise melumatlari images/${cardData.icon || 'default-icon'}.svg`;
              iconImg.alt = cardData.name || '';
              
              // Create name span
              const nameSpan = document.createElement('span');
              nameSpan.className = 'font-normal text-[12px] text-messages';
              nameSpan.textContent = cardData.name || '';
              
              // Append elements to card div
              cardDiv.appendChild(iconImg);
              cardDiv.appendChild(nameSpan);
              
              // Append card to container
              leftCardsContainer.appendChild(cardDiv);
              console.log(`🎴 LEFT SIDE - Added card ${index} to DOM:`, cardDiv.outerHTML);
            });
            
            console.log(`🎴 LEFT SIDE - Final container HTML:`, leftCardsContainer.outerHTML);
            console.log(`🎴 LEFT SIDE - Container has ${leftCardsContainer.children.length} child elements`);
        }
    }

    if(originalData.services && Array.isArray(originalData.services)) {
        const rightServicesContainer = document.querySelector('#restaurantDetailPopup .muessise-services'); 
      if (rightServicesContainer) {
        // Clear existing services
        rightServicesContainer.innerHTML = '';
        
        // Add each service
        originalData.services.forEach(service => {
          const serviceDiv = document.createElement('div');
          serviceDiv.className = 'px-2 py-1 text-[12px] flex items-center justify-center rounded-full bg-focus text-on-primary';
          serviceDiv.textContent = service;
          rightServicesContainer.appendChild(serviceDiv);
        });
      }
    }

    console.log("originalData.social_media", originalData.social_media);
    console.log("originalData.social", originalData.social);
    
    // Update social media on left side
    const leftSocialContainer = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:first-child .muessise-social');
    if (leftSocialContainer) {
      // Clear existing social media
      leftSocialContainer.innerHTML = '';
      
      if (originalData.social && Array.isArray(originalData.social) && originalData.social.length > 0) {
        console.log('📱 Updating left side social media display:', originalData.social);
        
        const socialIcons = {
          instagram: "skill-icons_instagram",
          facebook: "devicon_facebook", 
          whatsapp: "skill-icons_whatsapp",
          telegram: "skill-icons_telegram",
          linkedin: "devicon_linkedin",
          threads: "skill-icons_threads"
        };
        
        originalData.social.forEach((socialItem, index) => {
          console.log(`🐛 Processing social item ${index}:`, socialItem, typeof socialItem);
          
          // Handle different data formats
          let platform, url;
          
          if (Array.isArray(socialItem) && socialItem.length >= 2) {
            // Array format: [platform, url]
            platform = socialItem[0];
            url = socialItem[1];
            console.log('🐛 Array format detected:', { platform, url });
          } else if (typeof socialItem === 'object' && socialItem !== null) {
            // Object format: {platform: url} or similar
            const entries = Object.entries(socialItem);
            if (entries.length > 0) {
              platform = entries[0][0];
              url = entries[0][1];
              console.log('🐛 Object format detected:', { platform, url });
            }
          } else if (typeof socialItem === 'string') {
            // If it's just a string, it might be the platform name and we need to find the URL
            console.log('🐛 String format detected:', socialItem);
            // Skip for now as we don't have URL
            return;
          } else {
            console.log('🐛 Unknown format:', socialItem);
            return;
          }
          
          // Skip if we couldn't extract platform and url
          if (!platform || !url) {
            console.warn('⚠️ Invalid social media item:', socialItem);
            return;
          }
          
          console.log('📱 Processing social item:', { platform, url });
          
          const socialDiv = document.createElement('div');
          socialDiv.className = 'p-3 flex gap-2 border-b-[0.5px] border-[#0000001A] hover:bg-table-hover dark:hover:bg-[#242C30] cursor-pointer';
          
          const iconImg = document.createElement('img');
          iconImg.src = `/images/muessise melumatlari images/${socialIcons[platform] || 'default-icon'}.svg`;
          iconImg.alt = platform;
          
          const labelSpan = document.createElement('span');
          labelSpan.className = 'text-[13px] font-medium text-messages dark:text-[#FFFFFF] opacity-65';
          labelSpan.textContent = platform.charAt(0).toUpperCase() + platform.slice(1);
          
          socialDiv.appendChild(iconImg);
          socialDiv.appendChild(labelSpan);
          leftSocialContainer.appendChild(socialDiv);
        });
      } else {
        // No social media data - show placeholder
        console.log('📱 No social media data for left side');
        const noSocialDiv = document.createElement('div');
        noSocialDiv.className = 'p-3 text-center text-gray-500 dark:text-gray-400 text-sm opacity-65';
        noSocialDiv.textContent = 'Sosial media məlumatları yoxdur';
        leftSocialContainer.appendChild(noSocialDiv);
      }
    }
  }
  
  // Function to populate right side with changed data
  function populateRightSide(mergedData, changedData) {
    console.log('▶️ Populating right side with changed data', mergedData);
    
    // Update company name
    if (mergedData.sirket_name || mergedData.muessise_name) {
      const rightCompanyName = document.querySelector('#restaurantDetailPopup .restaurant-name');
      if (rightCompanyName) {
        rightCompanyName.textContent = mergedData.sirket_name || mergedData.muessise_name || '';
      }
    }
    
    // Update description
    if (mergedData.description) {
      const rightDescription = document.querySelector('#restaurantDetailPopup .restaurant-description');
      if (rightDescription) {
        rightDescription.textContent = mergedData.description;
      }
    }
    
    // Update address
    if (mergedData.address) {
      const rightAddress = document.querySelector('#restaurantDetailPopup .restaurant-address');
      if (rightAddress) {
        rightAddress.textContent = mergedData.address;
      }
    }
    
    // Update category
    if (mergedData.activity_type || mergedData.muessise_category) {
      const rightCategory = document.querySelector('#restaurantDetailPopup .restaurant-category');
      if (rightCategory) {
        rightCategory.textContent = mergedData.activity_type || mergedData.muessise_category || '';
      }
    }
    
    // Update phone numbers
    if (mergedData.contact_phone || mergedData.phone) {
      const rightPhones = document.querySelector('#restaurantDetailPopup .restaurant-phones');
      if (rightPhones) {
        let phoneText = '';
        if (mergedData.contact_phone) {
          phoneText = mergedData.phonePrefix + " " + mergedData.contact_phone;
        } else if (mergedData.phone && Array.isArray(mergedData.phone) && mergedData.phone.length > 0) {
          phoneText = mergedData.phone.map(p => `${mergedData.phonePrefix || ''} ${p.number || ''}`).join(', ');
        }
        rightPhones.textContent = phoneText;
      }
    }

    if(mergedData.contact_email || mergedData.email) {
    //    <div class="restaurant-email-wrapper">
    //         <div class="flex gap-[11px] items-center text-messages ">
    //           <span class="icon iconex-case-1 !w-[17px] !h-[16px] dark:text-[#FFFFFF]"></span>
    //           <span
    //             class="opacity-65 text-[13px] font-normal dark:text-[#FFFFFF] restaurant-emails">info.ozsut@ozsut.com.tr</span>
    //         </div>
    //       </div>
         const rightEmails = document.querySelector('#restaurantDetailPopup .restaurant-email-wrapper');
         if(rightEmails) {
                let emailText = '';
                if(mergedData.contact_email) {
                 emailText = mergedData.contact_email;
                } else if(mergedData.email && Array.isArray(mergedData.email) && mergedData.email.length > 0) {
                 emailText = mergedData.email.map(e => e.address || '').join(', ');
                }
                rightEmails.innerHTML = `<div class="flex gap-[11px] items-center text-messages ">
                      <span class="icon iconex-case-1 !w-[17px] !h-[16px] dark:text-[#FFFFFF]"></span>
                      <span
                        class="opacity-65 text-[13px] font-normal dark:text-[#FFFFFF] restaurant-emails">${emailText}</span>
                    </div>`;
         }
    }
    
    // Update services (array field)
    if (mergedData.services && Array.isArray(mergedData.services)) {
      const rightServicesContainer = document.querySelector('#restaurantDetailPopup .restaurant-services'); 
      if (rightServicesContainer) {
        // Clear existing services
        rightServicesContainer.innerHTML = '';
        
        // Add each service
        mergedData.services.forEach(service => {
          const serviceDiv = document.createElement('div');
          serviceDiv.className = 'px-2 py-1 text-[12px] flex items-center justify-center rounded-full bg-focus text-on-primary';
          serviceDiv.textContent = service;
          rightServicesContainer.appendChild(serviceDiv);
        });
      }
    }
    
    // Update cards (array field)
    if (mergedData.cards && Array.isArray(mergedData.cards)) {
      console.log('🎴 RIGHT SIDE DEBUG:');
      console.log('🎴 mergedData.cards (what should be SELECTED cards only):', mergedData.cards);
      console.log('🎴 mergedData.cards.length:', mergedData.cards.length);
      console.log('🎴 Expected: Should show only selected cards (2 cards in your case - food and fuel)');
      
      const rightCardsContainer = document.querySelector('#restaurantDetailPopup .w-\\[50\\%\\]:last-child .muessise-cards');
      console.log('🎴 RIGHT SIDE - Container found:', !!rightCardsContainer);
      console.log('🎴 RIGHT SIDE - Container selector:', '#restaurantDetailPopup .w-\\[50\\%\\]:last-child .muessise-cards');
      
      if (rightCardsContainer) {
        // Clear existing cards
        rightCardsContainer.innerHTML = '';
        console.log('🎴 RIGHT SIDE - Container cleared');
        
        // Add each card with proper styling like in the detail page
        mergedData.cards.forEach((card, index) => {
          console.log(`🎴 Right side - processing card ${index}:`, card, 'Type:', typeof card);
          
          // Handle different card data formats
          let cardData = card;
          
          // If card is just an ID string, we need to find the full card data
          if (typeof card === 'string') {
            console.log('🎴 Card is ID string, need to find full card data:', card);
            // We can't resolve this without the full cards list, skip for now
            return;
          }
          
          // If card is an object but missing properties, log it
          if (typeof card === 'object') {
            console.log('🎴 Card object properties:', Object.keys(card));
            console.log('🎴 Card icon:', card.icon, 'Card name:', card.name);
          }
          
          const cardDiv = document.createElement('div');
          cardDiv.className = 'w-[84px] h-[27px] flex gap-1 items-center justify-center rounded-full';
          cardDiv.style.backgroundColor = cardData.background_color || '#ffffff';
          
          // Create icon element
          const iconImg = document.createElement('img');
          iconImg.className = 'w-[16px] h-[16px]';
          iconImg.src = `/images/muessise melumatlari images/${cardData.icon || 'default-icon'}.svg`;
          iconImg.alt = cardData.name || '';
          
          // Create name span
          const nameSpan = document.createElement('span');
          nameSpan.className = 'font-normal text-[12px] text-messages';
          nameSpan.textContent = cardData.name || '';
          
          // Append elements to card div
          cardDiv.appendChild(iconImg);
          cardDiv.appendChild(nameSpan);
          
          // Append card to container
          rightCardsContainer.appendChild(cardDiv);
          console.log(`🎴 RIGHT SIDE - Added card ${index} to DOM:`, cardDiv.outerHTML);
        });
        
        console.log(`🎴 RIGHT SIDE - Final container HTML:`, rightCardsContainer.outerHTML);
        console.log(`🎴 RIGHT SIDE - Container has ${rightCardsContainer.children.length} child elements`);
      }
    }
    
    // Update schedule (working days)
    if (mergedData.schedule) {
      const rightScheduleContainer = document.querySelector('#restaurantDetailPopup .restaurant-schedule-wrapper');
      if (rightScheduleContainer) {
        console.log('📅 Updating schedule display:', mergedData.schedule);
        
        // Clear existing schedule
        rightScheduleContainer.innerHTML = '';
        
        const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
        const imgBasePath = "/images/muessise melumatlari images/Frame 427321302";
        
        days.forEach((day, index) => {
          const dayDiv = document.createElement('div');
          dayDiv.className = 'relative group flex items-center gap-1';
          
          // Create day icon
          const dayImg = document.createElement('img');
          dayImg.className = 'w-[34px] h-[34px]';
          dayImg.src = imgBasePath + (index === 0 ? '' : ' (' + index + ')') + '.svg';
          dayImg.alt = day;
          
          // Create tooltip
          const tooltipDiv = document.createElement('div');
          tooltipDiv.className = 'absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-max px-2 py-1 text-xs text-on-primary bg-messages rounded opacity-0 group-hover:opacity-100 transition-opacity z-10';
          
          const scheduleValue = mergedData.schedule[day];
          let tooltipText = 'İş günü yoxdur';
          
          if (scheduleValue && scheduleValue.enabled && scheduleValue.open && scheduleValue.close) {
            tooltipText = `${scheduleValue.open} - ${scheduleValue.close}`;
          } else if (scheduleValue && scheduleValue.enabled && scheduleValue.start && scheduleValue.end) {
            tooltipText = `${scheduleValue.start} - ${scheduleValue.end}`;
          }
          
          tooltipDiv.textContent = tooltipText;
          
          // Create tooltip arrow
          const arrowDiv = document.createElement('div');
          arrowDiv.className = 'absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-l-8 border-r-8 border-t-[8px] border-t-messages border-transparent z-15';
          
          tooltipDiv.appendChild(arrowDiv);
          dayDiv.appendChild(dayImg);
          dayDiv.appendChild(tooltipDiv);
          rightScheduleContainer.appendChild(dayDiv);
        });
      }
    }
    
    // Update social media
    if (mergedData.social && Array.isArray(mergedData.social)) {
      const rightSocialContainer = document.querySelector('#restaurantDetailPopup .restaurant-social');
      if (rightSocialContainer) {
        console.log('📱 Updating right side social media display:', mergedData.social);

        // Clear existing social media
        rightSocialContainer.innerHTML = '';
        
        const socialIcons = {
          instagram: "skill-icons_instagram",
          facebook: "devicon_facebook", 
          whatsapp: "skill-icons_whatsapp",
          telegram: "skill-icons_telegram",
          linkedin: "devicon_linkedin",
          threads: "skill-icons_threads"
        };
        
        mergedData.social.forEach((socialItem) => {
          // Handle different data formats
          let platform, url;
          
          if (Array.isArray(socialItem) && socialItem.length >= 2) {
            // Array format: [platform, url]
            platform = socialItem[0];
            url = socialItem[1];
          } else if (typeof socialItem === 'object' && socialItem !== null) {
            // Object format: {platform: url} or similar
            const entries = Object.entries(socialItem);
            if (entries.length > 0) {
              platform = entries[0][0];
              url = entries[0][1];
            }
          }
          
          // Skip if we couldn't extract platform and url
          if (!platform || !url) {
            console.warn('⚠️ Invalid social media item:', socialItem);
            return;
          }
          
          console.log('📱 Processing right side social item:', { platform, url });
          
          const socialDiv = document.createElement('div');
          socialDiv.className = 'flex item-center justify-between p-3 border-b-[0.5px] border-[#0000001A] dark:border-[#FFFFFF1A]';
          
          const contentDiv = document.createElement('div');
          contentDiv.className = 'flex gap-2 items-center';
          
          const iconImg = document.createElement('img');
          iconImg.src = `/images/muessise melumatlari images/${socialIcons[platform] || 'default-icon'}.svg`;
          iconImg.alt = platform;
          
          const labelSpan = document.createElement('span');
          labelSpan.className = 'text-[13px] font-medium text-messages dark:text-[#FFFFFF] opacity-65';
          labelSpan.textContent = platform.charAt(0).toUpperCase() + platform.slice(1);
          
          contentDiv.appendChild(iconImg);
          contentDiv.appendChild(labelSpan);
          socialDiv.appendChild(contentDiv);
          rightSocialContainer.appendChild(socialDiv);
        });
      }
    }

    if(mergedData.contact_website || mergedData.website) {
        const rightWebsite = document.querySelector('#restaurantDetailPopup .restaurant-websites');
        if(rightWebsite) {
            let websiteText = '';
            if(mergedData.contact_website) {
             websiteText = mergedData.contact_website;
            } else if(mergedData.website && Array.isArray(mergedData.website) && mergedData.website.length > 0) {
             websiteText = mergedData.website.map(w => w.address || '').join(', ');
            }
            rightWebsite.innerHTML = `<div
            class="p-3 flex gap-2 items-center hover:bg-table-hover dark:hover:bg-[#242C30] cursor-pointer restaurant-websites">
            <div class="icon iconex-link-1 w-[9px] h-[17px] dark:text-[#FFFFFF]"></div>
            <span class="text-[13px] font-medium text-messages dark:text-[#FFFFFF] opacity-65">${websiteText}</span>
          </div>`;
        }
    }
  }
  // Function to add a summary banner at the top of the modal
  function addComparisonSummary(changedFieldsCount) {
    const modalContent = document.querySelector('#restaurantDetailPopup .bg-white');
    if (modalContent) {
      // Remove existing summary if any
      const existingSummary = modalContent.querySelector('.comparison-summary');
      if (existingSummary) {
        existingSummary.remove();
      }
      
      // Create new summary banner
    //   const summaryDiv = document.createElement('div');
    //   summaryDiv.className = 'comparison-summary bg-gradient-to-r from-orange-100 to-yellow-100 dark:from-orange-900 dark:to-yellow-900 p-3 border-b border-orange-200 dark:border-orange-700';
    //   summaryDiv.innerHTML = `
    //     <div class="flex items-center justify-between">
    //       <div class="flex items-center gap-2">
    //         <span class="text-orange-600 dark:text-orange-400">📋</span>
    //         <span class="text-sm font-medium text-orange-800 dark:text-orange-200">
    //           ${changedFieldsCount} sahədə dəyişiklik aşkarlandı
    //         </span>
    //       </div>
    //       <div class="text-xs text-orange-600 dark:text-orange-400">
    //         🟥 Köhnə → 🟩 Yeni
    //       </div>
    //     </div>
    //   `;
      
    //   // Insert after the header
    //   const header = modalContent.querySelector('.flex.items-center.justify-between.border-b');
    //   if (header) {
    //     header.insertAdjacentElement('afterend', summaryDiv);
    //   }
    }
  }

  // Simple function to close the modal
  function closeDiffModal() {
    console.log('🔒 Closing restaurant detail modal...');
    const modal = document.getElementById('restaurantDetailPopup');
    if (modal) {
      modal.classList.add('hidden');
      modal.style.display = 'none';
      console.log('✅ Modal closed successfully');
    }
  }

  // Use the existing close function from restaurant details
  function closeRestaurantDetailPopup() {
    closeDiffModal();
  }

  // Function to apply changes to the API (called from Təsdiqlə button)
  function applyMuessiseChanges() {
    console.log('🔄 Applying muessise changes to API...');
    
    // Get current muessise ID
    const currentMuessiseId = '<%= newMuessise._id || newMuessise.muessise_id %>';
    
    const tempChanges = JSON.parse(sessionStorage.getItem('muessise_temp_changes') || '{}');
    const originalData = JSON.parse(sessionStorage.getItem('muessise_original_data') || '{}');
    
    // Validate that we're applying changes to the correct muessise
    if (originalData.muessise_id && originalData.muessise_id !== currentMuessiseId) {
      console.log('⚠️ SessionStorage data is for different muessise, clearing and aborting');
      sessionStorage.removeItem('muessise_temp_changes');
      sessionStorage.removeItem('muessise_original_data');
      alert('Məlumatlar fərqli müəssisəyə aiddir. Zəhmət olmasa yenidən redaktə edin.');
      closeRestaurantDetailPopup();
      return;
    }
    
    if (Object.keys(tempChanges).length === 0) {
      alert('Heç bir dəyişiklik tapılmadı');
      closeRestaurantDetailPopup();
      return;
    }
    
    // Prepare the data for API
    const updateData = { ...tempChanges };
    updateData.muessise_id = currentMuessiseId;
    

    // Get CSRF token
    let csrfToken = document.querySelector('input[name="_csrf"]')?.value;
    if (!csrfToken) {
      csrfToken = '<%= csrfToken %>';
    }
    
    // Create form data with proper array handling
    const formData = new FormData();
    Object.keys(updateData).forEach(key => {
      const value = updateData[key];
      
      // Handle array fields (services, cards, etc.)
      if (Array.isArray(value)) {
        // For arrays, append each value with the array notation
        value.forEach(item => {
          formData.append(key + '[]', item);
        });
      } else {
        // For regular fields, append as normal
        formData.append(key, value);
      }
    });
    
    if (csrfToken) {
      formData.append('_csrf', csrfToken);
    }
    
    // Show loading state
    const confirmBtn = document.querySelector('button[onclick="applyMuessiseChanges()"]');
    const originalText = confirmBtn ? confirmBtn.textContent : '';
    if (confirmBtn) {
      confirmBtn.textContent = 'Tətbiq edilir...';
      confirmBtn.disabled = true;
    }
    
    // Send to API
    fetch('/muessiseler/update', {
      method: 'POST',
      body: formData,
      headers: {
        'X-Requested-With': 'XMLHttpRequest',
        'CSRF-Token': csrfToken
      }
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        
        // Clear temporary changes from sessionStorage
        sessionStorage.removeItem('muessise_temp_changes');
        
        // Update the original data in sessionStorage with the latest data from API
        if (data.updatedData) {
          sessionStorage.setItem('muessise_original_data', JSON.stringify(data.updatedData));
        }
        
        // Close modal
        closeRestaurantDetailPopup();
        
        // Show success message
        alert('Dəyişikliklər müvəffəqiyyətlə tətbiq edildi!');
        
        // Reload page to show updated data
        setTimeout(() => {
          window.location.reload();
        }, 1500);
      } else {
        throw new Error(data.message || 'Xəta baş verdi');
      }
    })
    .catch(error => {
      console.error('❌ Error applying changes:', error);
      alert('Dəyişikliklər tətbiq edilərkən xəta baş verdi: ' + error.message);
    })
    .finally(() => {
      // Reset button state
      if (confirmBtn) {
        confirmBtn.textContent = originalText;
        confirmBtn.disabled = false;
      }
    });
  }

  // Immediately expose functions to window
  window.saveMuessiseChangesTemporarily = saveMuessiseChangesTemporarily;
  window.showChangesDiffModal = showChangesDiffModal;
  window.populateComparisonModal = populateComparisonModal;
  window.populateLeftSide = populateLeftSide;
  window.populateRightSide = populateRightSide;
//   window.highlightChangedFields = highlightChangedFields;
  window.closeDiffModal = closeDiffModal;
  window.closeRestaurantDetailPopup = closeRestaurantDetailPopup;
  window.applyMuessiseChanges = applyMuessiseChanges;
  
  console.log('✅ Diff modal functions loaded:', {
    saveMuessiseChangesTemporarily: typeof window.saveMuessiseChangesTemporarily,
    showChangesDiffModal: typeof window.showChangesDiffModal,
    populateComparisonModal: typeof window.populateComparisonModal,
    populateLeftSide: typeof window.populateLeftSide,
    populateRightSide: typeof window.populateRightSide,
    // highlightChangedFields: typeof window.highlightChangedFields,
    closeDiffModal: typeof window.closeDiffModal,
    closeRestaurantDetailPopup: typeof window.closeRestaurantDetailPopup,
    applyMuessiseChanges: typeof window.applyMuessiseChanges
  });
  
  // Initialize page - check for stale sessionStorage data
  function initializePage() {
    const currentMuessiseId = '<%= newMuessise._id || newMuessise.muessise_id %>';
    console.log('🔄 Initializing page for muessise:', currentMuessiseId);
    
    // Check if sessionStorage has data for a different muessise
    const existingOriginalData = sessionStorage.getItem('muessise_original_data');
    if (existingOriginalData) {
      try {
        const parsedExistingData = JSON.parse(existingOriginalData);
        if (parsedExistingData.muessise_id && parsedExistingData.muessise_id !== currentMuessiseId) {
          console.log('🧹 Clearing stale sessionStorage data from different muessise');
          console.log('   - Stored muessise ID:', parsedExistingData.muessise_id);
          console.log('   - Current muessise ID:', currentMuessiseId);
          sessionStorage.removeItem('muessise_temp_changes');
          sessionStorage.removeItem('muessise_original_data');
        }
      } catch (e) {
        console.log('⚠️ Error parsing existing sessionStorage, clearing all');
        sessionStorage.removeItem('muessise_temp_changes');
        sessionStorage.removeItem('muessise_original_data');
      }
    }
  }
  
  // Run initialization when page loads
  initializePage();
</script>
